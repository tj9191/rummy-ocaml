// Generated by js_of_ocaml
//# buildInfo:effects=false, kind=cma, use-js-string=true, version=5.6.0

//# unitInfo: Provides: Ui_time_source
//# unitInfo: Requires: Core, Core__List, Core__Time_ns, Ppx_bench_lib__Benchmark_accumulator, Ppx_expect_runtime, Ppx_inline_test_lib, Ppx_module_timer_runtime, Reversed_list, Sexplib0__Sexp_conv, Timing_wheel, Ui_effect, Ui_incr
(function
  (globalThis){
   "use strict";
   var
    runtime = globalThis.jsoo_runtime,
    cst_Ui_time_source$0 = "Ui_time_source",
    cst_ui_time_source$0 = "ui_time_source",
    cst_ui_time_source_ui_time_sou = "ui_time_source/ui_time_source.ml",
    caml_maybe_attach_backtrace = runtime.caml_maybe_attach_backtrace;
   function caml_call1(f, a0){
    return (f.l >= 0 ? f.l : f.l = f.length) == 1
            ? f(a0)
            : runtime.caml_call_gen(f, [a0]);
   }
   function caml_call2(f, a0, a1){
    return (f.l >= 0 ? f.l : f.l = f.length) == 2
            ? f(a0, a1)
            : runtime.caml_call_gen(f, [a0, a1]);
   }
   function caml_call3(f, a0, a1, a2){
    return (f.l >= 0 ? f.l : f.l = f.length) == 3
            ? f(a0, a1, a2)
            : runtime.caml_call_gen(f, [a0, a1, a2]);
   }
   var
    global_data = runtime.caml_get_global_data(),
    Reversed_list = global_data.Reversed_list,
    Ui_effect = global_data.Ui_effect,
    Core_List = global_data.Core__List,
    Timing_wheel = global_data.Timing_wheel,
    Ui_incr = global_data.Ui_incr,
    Core_Time_ns = global_data.Core__Time_ns,
    Assert_failure = global_data.Assert_failure,
    Sexplib0_Sexp_conv = global_data.Sexplib0__Sexp_conv,
    Core = global_data.Core,
    Ppx_module_timer_runtime = global_data.Ppx_module_timer_runtime,
    Ppx_bench_lib_Benchmark_accumu =
      global_data.Ppx_bench_lib__Benchmark_accumulator,
    Ppx_expect_runtime = global_data.Ppx_expect_runtime,
    Ppx_inline_test_lib = global_data.Ppx_inline_test_lib;
   caml_call1(Ppx_module_timer_runtime[4], cst_Ui_time_source$0);
   caml_call1(Ppx_bench_lib_Benchmark_accumu[1][1], cst_ui_time_source$0);
   caml_call1(Ppx_expect_runtime[1][1], cst_ui_time_source_ui_time_sou);
   caml_call2
    (Ppx_inline_test_lib[6], cst_ui_time_source$0, "ui_time_source.ml");
   var
    _c_ = [0, cst_ui_time_source_ui_time_sou, 66, 2],
    _a_ = [0, "incr_now"],
    _b_ = [0, "wheel_now"],
    cst_BUG_timing_wheel_and_incre =
      "BUG: timing wheel and incremental clock are out of sync",
    cst_ui_time_source = cst_ui_time_source$0,
    cst_Ui_time_source = cst_Ui_time_source$0;
   function invariant(t){
    var
     wheel_now = caml_call1(Timing_wheel[11], t[2]),
     incr_now = caml_call1(Ui_incr[80][6], t[1]),
     _r_ = 1 - caml_call2(Core_Time_ns[21], wheel_now, incr_now);
    if(! _r_) return _r_;
    var
     _s_ =
       [0,
        [1, [0, _a_, [0, caml_call1(Core_Time_ns[25][12], incr_now), 0]]],
        0],
     _t_ =
       [0,
        [1, [0, _b_, [0, caml_call1(Core_Time_ns[25][12], wheel_now), 0]]],
        _s_],
     _u_ =
       [1,
        [0,
         caml_call1(Sexplib0_Sexp_conv[7], cst_BUG_timing_wheel_and_incre),
         _t_]];
    return caml_call2(Core[257], 0, _u_);
   }
   function create(start){
    var
     _q_ = caml_call1(Core_Time_ns[93], start),
     start$0 = caml_call1(Core_Time_ns[95], _q_),
     config = Ui_incr[80][2],
     incr = caml_call3(Ui_incr[80][3], [0, config], start$0, 0),
     timing_wheel = caml_call2(Timing_wheel[9], config, start$0),
     t = [0, incr, timing_wheel, 0, 0, 0];
    invariant(t);
    return t;
   }
   function incr_clock(t){return t[1];}
   function now(t){
    var match = t[5];
    if(! match) return caml_call1(Timing_wheel[11], t[2]);
    var to = match[1];
    return to;
   }
   function at_intervals(t, span){
    return caml_call2(Ui_incr[80][12], t[1], span);
   }
   function watch_now(t){return caml_call1(Ui_incr[80][7], t[1]);}
   function at(t, at){return caml_call2(Ui_incr[80][10], t[1], at);}
   function advance_clock(t, to){
    var _p_ = now(t);
    if(! caml_call2(Core_Time_ns[15], to, _p_))
     throw caml_maybe_attach_backtrace([0, Assert_failure, _c_], 1);
    t[5] = [0, to];
    return 0;
   }
   function advance_clock_by(t, span){
    var _o_ = now(t);
    return advance_clock(t, caml_call2(Core_Time_ns[67], _o_, span));
   }
   function until(t, at){
    function _n_(callback){t[3] = [0, [0, at, callback], t[3]]; return 0;}
    return caml_call2(Ui_effect[22][2], 0, _n_);
   }
   function sleep(t, span){
    function _l_(callback){
     var _m_ = now(t), at = caml_call2(Core_Time_ns[67], _m_, span);
     t[3] = [0, [0, at, callback], t[3]];
     return 0;
    }
    return caml_call2(Ui_effect[22][2], 0, _l_);
   }
   function wait_after_display(t){
    function _k_(callback){t[4] = [0, callback, t[4]]; return 0;}
    return caml_call2(Ui_effect[22][2], 0, _k_);
   }
   function flush(t){
    function handle_fired(callback){
     var
      _i_ = caml_call2(Timing_wheel[5][5], t[2], callback),
      _j_ = caml_call2(Ui_effect[22][1][3], _i_, 0);
     return caml_call1(Ui_effect[21][2], _j_);
    }
    function _g_(param){
     var callback = param[2], at = param[1];
     caml_call3(Timing_wheel[26], t[2], at, callback);
     return 0;
    }
    var _h_ = caml_call1(Reversed_list[3], t[3]);
    caml_call2(Core_List[19], _h_, _g_);
    t[3] = 0;
    var match = t[5];
    if(match){
     var to = match[1];
     t[5] = 0;
     caml_call3(Timing_wheel[20], t[2], to, handle_fired);
     caml_call2(Timing_wheel[22], t[2], handle_fired);
     caml_call2(Ui_incr[80][8], t[1], to);
    }
    else
     caml_call2(Timing_wheel[22], t[2], handle_fired);
    return invariant(t);
   }
   function trigger_after_display(t){
    var callbacks = t[4];
    t[4] = 0;
    function _d_(callback){
     var _f_ = caml_call2(Ui_effect[22][1][3], callback, 0);
     return caml_call1(Ui_effect[21][2], _f_);
    }
    var _e_ = caml_call1(Reversed_list[3], callbacks);
    return caml_call2(Core_List[19], _e_, _d_);
   }
   function has_after_display_events(t){
    return 1 - caml_call1(Reversed_list[7], t[4]);
   }
   var Private = [0, flush, trigger_after_display, has_after_display_events];
   caml_call1(Ppx_inline_test_lib[7], cst_ui_time_source);
   caml_call1(Ppx_expect_runtime[1][2], 0);
   caml_call1(Ppx_bench_lib_Benchmark_accumu[1][2], 0);
   caml_call1(Ppx_module_timer_runtime[5], cst_Ui_time_source);
   var
    Ui_time_source =
      [0,
       create,
       incr_clock,
       advance_clock_by,
       advance_clock,
       now,
       watch_now,
       at_intervals,
       at,
       until,
       sleep,
       wait_after_display,
       Private];
   runtime.caml_register_global(24, Ui_time_source, cst_Ui_time_source$0);
   return;
  }
  (globalThis));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLjAsImZpbGUiOiJ1aV90aW1lX3NvdXJjZS5jbWEuanMiLCJzb3VyY2VSb290IjoiIiwibmFtZXMiOlsiaW52YXJpYW50IiwidCIsIndoZWVsX25vdyIsImluY3Jfbm93IiwiY3JlYXRlIiwic3RhcnQiLCJzdGFydCQwIiwiY29uZmlnIiwiaW5jciIsInRpbWluZ193aGVlbCIsImluY3JfY2xvY2siLCJub3ciLCJ0byIsImF0X2ludGVydmFscyIsInNwYW4iLCJ3YXRjaF9ub3ciLCJhdCIsImFkdmFuY2VfY2xvY2siLCJhZHZhbmNlX2Nsb2NrX2J5IiwidW50aWwiLCJjYWxsYmFjayIsInNsZWVwIiwid2FpdF9hZnRlcl9kaXNwbGF5IiwiZmx1c2giLCJoYW5kbGVfZmlyZWQiLCJ0cmlnZ2VyX2FmdGVyX2Rpc3BsYXkiLCJjYWxsYmFja3MiLCJoYXNfYWZ0ZXJfZGlzcGxheV9ldmVudHMiXSwic291cmNlcyI6WyIvVXNlcnMvdHlsYW5tb3Jhbi8ub3BhbS81LjEuMS9saWIvaW5jcl9kb20vdWlfdGltZV9zb3VyY2UvdWlfdGltZV9zb3VyY2UubWwiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0c7Ozs7O0c7Ozs7O0c7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7WUFnQklBLFVBQVVDO0lBSVo7S0FBSUMsWUFBWSw2QkFKSkQ7S0FLUkUsV0FBVywyQkFMSEY7S0FNTCxVQUFBLDZCQUZIQyxXQUNBQztjQUNHOzs7OzBEQURIQTs7OzswREFEQUQ7Ozs7Ozs7O0dBUTBDO1lBRzVDRSxPQUFRQztJQUNWO0tBR0ksTUFBQSw2QkFKTUE7S0FDTkMsVUFFRjtLQUdFQztLQUNBQyxPQUFPLCtCQURQRCxTQUxBRDtLQU9BRyxlQUFlLDRCQUZmRixRQUxBRDtLQVFBTCxRQUZBTyxNQUNBQztJQXZCRlQsVUF3QkVDO0lBUUosT0FSSUE7R0FTSDtZQUdDUyxXQUFXVCxHQUFJLE9BQUpBLEtBQVU7WUFFckJVLElBQUlWO0lBQ04sWUFETUE7b0RBQUFBO1FBRUNXO0lBQU8sT0FBUEE7R0FDa0M7WUFHdkNDLGFBQWFaLEdBQUVhO0lBQU8sT0FBQSw0QkFBVGIsTUFBRWE7R0FBMEM7WUFDekRDLFVBQVVkLEdBQUksa0NBQUpBLE1BQStCO1lBQ3pDZSxHQUFHZixHQUFFZSxJQUFLLE9BQUEsNEJBQVBmLE1BQUVlLElBQTRCO1lBRWpDQyxjQUFjaEIsR0FBR1c7SUFDUSxVQVh6QkQsSUFVY1Y7SUFDVCxLQUFBLDZCQURZVztLQUNuQixNQUFBO0lBRGdCWCxXQUFHVzs7R0FFSztZQUd0Qk0saUJBQWlCakIsR0FBRWE7SUFBeUMsVUFmNURILElBZWlCVjtJQUE4QixPQUwvQ2dCLGNBS2lCaEIsR0FBOEIsa0NBQTVCYTtHQUFzRDtZQVN6RUssTUFBTWxCLEdBQUVlO2lCQUNzQ0ksVUFEeENuQixlQUFFZSxJQUNzQ0ksV0FEeENuQixnQkFFd0Q7SUFEckIsT0FBQTtHQUNzQjtZQUcvRG9CLE1BQU1wQixHQUFFYTtpQkFDc0NNO0tBQzlDLElBQXFCLE1BL0JyQlQsSUE2Qk1WLElBRUZlLEtBQUssa0NBRkRGO0tBQUZiLGVBRUZlLElBRDBDSSxXQUR4Q25COztJQUd3RDtJQUZyQixPQUFBO0dBRXNCO1lBRy9EcUIsbUJBQW1CckI7aUJBQzJCbUIsVUFEM0JuQixXQUMyQm1CLFVBRDNCbkIsZ0JBRXlEO0lBRG5DLE9BQUE7R0FDb0M7WUFJM0VzQixNQUFNdEI7YUFDSnVCLGFBQWFKO0tBQ2Y7TUFFSyxNQUFBLCtCQUpDbkIsTUFDU21CO01BRWIsTUFBQTtLQUFBLE9BQUE7SUFFTTtJQUVWO0tBQXNELElBQVVBLHFCQUFKSjtLQUN2Qiw2QkFSN0JmLE1BT29EZSxJQUFJSTtLQUMzQjtJQUNoQztJQUZLLFVBQUEsNkJBUEZuQjtJQU9SO0lBUFFBO2dCQUFBQTs7U0FZQVc7S0FaQVg7S0FjTCw2QkFkS0EsTUFZQVcsSUFYSlk7S0FjRCw2QkFmS3ZCLE1BQ0p1QjtLQWVELDJCQWhCS3ZCLE1BWUFXOzs7S0FLRyw2QkFqQkhYLE1BQ0p1QjtJQWlCSixPQWpHQXhCLFVBK0VRQztHQWtCRztZQUdUd0Isc0JBQXNCeEI7SUFDeEIsSUFBSXlCLFlBRG9CekI7SUFBQUE7SUFHeEIsYUFBZ0RtQjtLQUN6QixVQUFBLGdDQUR5QkE7S0FDekIsT0FBQTtJQUFnRDtJQUQ3RCxVQUFBLDZCQUZOTTtJQUV1QyxPQUFBO0dBQzZCO1lBR3RFQyx5QkFBeUIxQjtJQUMzQixXQUFJLDZCQUR1QkE7R0FDZ0M7R0E5QjlDLGtCQUNYc0IsT0FxQkFFLHVCQU9BRTs7Ozs7Ozs7T0E1RkZ2QjtPQXFCQU07T0FpQkFRO09BTEFEO09BVkFOO09BT0FJO09BREFGO09BRUFHO09BZ0JBRztPQUtBRTtPQU1BQzs7OztFIiwic291cmNlc0NvbnRlbnQiOlsib3BlbiEgQ29yZVxubW9kdWxlIEluY3IgPSBVaV9pbmNyXG5tb2R1bGUgRWZmZWN0ID0gVWlfZWZmZWN0XG5cbnR5cGUgdCA9XG4gIHsgaW5jciA6IEluY3IuQ2xvY2sudFxuICA7IHRpbWluZ193aGVlbCA6ICh1bml0LCB1bml0KSBVaV9lZmZlY3QuUHJpdmF0ZS5DYWxsYmFjay50IFRpbWluZ193aGVlbC50XG4gIDsgbXV0YWJsZVxuICAgICAgYWRkX2JlZm9yZV9hZHZhbmNlIDpcbiAgICAgIChUaW1lX25zLnQgKiAodW5pdCwgdW5pdCkgVWlfZWZmZWN0LlByaXZhdGUuQ2FsbGJhY2sudCkgUmV2ZXJzZWRfbGlzdC50XG4gIDsgbXV0YWJsZVxuICAgICAgd2FpdF9hZnRlcl9kaXNwbGF5X2NhbGxiYWNrcyA6XG4gICAgICAodW5pdCwgdW5pdCkgVWlfZWZmZWN0LlByaXZhdGUuQ2FsbGJhY2sudCBSZXZlcnNlZF9saXN0LnRcbiAgOyBtdXRhYmxlIGFkdmFuY2VfdG8gOiBUaW1lX25zLnQgb3B0aW9uXG4gIH1cblxubGV0IGludmFyaWFudCB0ID1cbiAgKCogVGhpcyBpcyBvbmx5IGEgc29mdCBpbnZhcmlhbnQgKGl0IHByaW50cyBpbnN0ZWFkIG9mIHJhaXNpbmcpIGJlY2F1c2UgaXRcbiAgICAgcHJvYmFibHkgaXNuJ3QgZmF0YWwgaWYgdGhlIHR3byBjbG9ja3MgYXJlIG91dCBvZiBzeW5jLiBXZSB3YW50IHRvIGtub3dcbiAgICAgYWJvdXQgaXQgaWYgdGhleSBhcmUsIHRob3VnaC4gKilcbiAgbGV0IHdoZWVsX25vdyA9IFRpbWluZ193aGVlbC5ub3cgdC50aW1pbmdfd2hlZWwgaW5cbiAgbGV0IGluY3Jfbm93ID0gSW5jci5DbG9jay5ub3cgdC5pbmNyIGluXG4gIGlmIG5vdCAoVGltZV9ucy5lcXVhbCB3aGVlbF9ub3cgaW5jcl9ub3cpXG4gIHRoZW5cbiAgICBlcHJpbnRfc1xuICAgICAgWyVtZXNzYWdlXG4gICAgICAgIFwiQlVHOiB0aW1pbmcgd2hlZWwgYW5kIGluY3JlbWVudGFsIGNsb2NrIGFyZSBvdXQgb2Ygc3luY1wiXG4gICAgICAgICAgKHdoZWVsX25vdyA6IFRpbWVfbnMuQWx0ZXJuYXRlX3NleHAudClcbiAgICAgICAgICAoaW5jcl9ub3cgOiBUaW1lX25zLkFsdGVybmF0ZV9zZXhwLnQpXVxuOztcblxubGV0IGNyZWF0ZSB+c3RhcnQgPVxuICBsZXQgc3RhcnQgPVxuICAgICgqIFdlIHJvdW5kIHRoZSBzdGFydCB0aW1lIHRvIG1hdGNoIHdoYXQgW0luY3IuQ2xvY2suY3JlYXRlXSBkb2VzLiAqKVxuICAgIFRpbWVfbnMub2ZfdGltZV9mbG9hdF9yb3VuZF9uZWFyZXN0X21pY3Jvc2Vjb25kXG4gICAgICAoVGltZV9ucy50b190aW1lX2Zsb2F0X3JvdW5kX25lYXJlc3RfbWljcm9zZWNvbmQgc3RhcnQpXG4gIGluXG4gIGxldCBjb25maWcgPSBJbmNyLkNsb2NrLmRlZmF1bHRfdGltaW5nX3doZWVsX2NvbmZpZyBpblxuICBsZXQgaW5jciA9IEluY3IuQ2xvY2suY3JlYXRlIH50aW1pbmdfd2hlZWxfY29uZmlnOmNvbmZpZyB+c3RhcnQgKCkgaW5cbiAgbGV0IHRpbWluZ193aGVlbCA9IFRpbWluZ193aGVlbC5jcmVhdGUgfmNvbmZpZyB+c3RhcnQgaW5cbiAgbGV0IHQgPVxuICAgIHsgaW5jclxuICAgIDsgdGltaW5nX3doZWVsXG4gICAgOyBhZGRfYmVmb3JlX2FkdmFuY2UgPSBbXVxuICAgIDsgd2FpdF9hZnRlcl9kaXNwbGF5X2NhbGxiYWNrcyA9IFtdXG4gICAgOyBhZHZhbmNlX3RvID0gTm9uZVxuICAgIH1cbiAgaW5cbiAgaW52YXJpYW50IHQ7XG4gIHRcbjs7XG5cbmxldCBpbmNyX2Nsb2NrIHQgPSB0LmluY3JcblxubGV0IG5vdyB0ID1cbiAgbWF0Y2ggdC5hZHZhbmNlX3RvIHdpdGhcbiAgfCBTb21lIHRvXyAtPiB0b19cbiAgfCBOb25lIC0+IFRpbWluZ193aGVlbC5ub3cgdC50aW1pbmdfd2hlZWxcbjs7XG5cbmxldCBhdF9pbnRlcnZhbHMgdCBzcGFuID0gSW5jci5DbG9jay5hdF9pbnRlcnZhbHMgdC5pbmNyIHNwYW5cbmxldCB3YXRjaF9ub3cgdCA9IEluY3IuQ2xvY2sud2F0Y2hfbm93IHQuaW5jclxubGV0IGF0IHQgYXQgPSBJbmNyLkNsb2NrLmF0IHQuaW5jciBhdFxuXG5sZXQgYWR2YW5jZV9jbG9jayB0IH50b18gPVxuICBhc3NlcnQgKFRpbWVfbnMuKCA+PSApIHRvXyAobm93IHQpKTtcbiAgdC5hZHZhbmNlX3RvIDwtIFNvbWUgdG9fXG47O1xuXG5sZXQgYWR2YW5jZV9jbG9ja19ieSB0IHNwYW4gPSBhZHZhbmNlX2Nsb2NrIHQgfnRvXzooVGltZV9ucy5hZGQgKG5vdyB0KSBzcGFuKVxuXG4oKiBbdW50aWxdLCBbc2xlZXBdLCBhbmQgW3dhaXRfYWZ0ZXJfZGlzcGxheV0gYWxsIHdhbnQgdG8gYWRkIGFsYXJtcyB0byBbdC50aW1pbmdfd2hlZWxdLFxuICAgd2hpY2ggdGhyb3dzIGlmIHdlJ3JlIGFscmVhZHkgaW4gdGhlIG1pZGRsZSBvZiBhbiBhbGFybS4gSW5zdGVhZCBvZiBhZGRpbmcgaXQgdG8gdGhlXG4gICB0aW1pbmcgd2hlZWwgaW1tZWRpYXRlbHksIHdlIHN0b3JlIGl0IGFuZCB0aGVuIGFkZCBpdCBuZXh0IHRpbWUgdGhlIHRpbWluZyB3aGVlbCBpc1xuICAgYWR2YW5jZWQuXG5cbiAgIE5vdGU6IHRoZSBhbGFybXMgYXJlIGFkZGVkIGFzIHBhcnQgb2YgW2ZsdXNoXSwgd2hpY2ggaXMgdGhlIG9ubHkgcGxhY2UgdGhhdCB3ZSBhY3R1YWxseVxuICAgYWR2YW5jZSBbdC50aW1lX3NvdXJjZV0sIHdoaWNoIG1ha2VzIHRoaXMgYXBwcm9hY2ggc291bmQuICopXG5sZXQgdW50aWwgdCBhdCA9XG4gIEVmZmVjdC5Qcml2YXRlLm1ha2UgfnJlcXVlc3Q6KCkgfmV2YWx1YXRvcjooZnVuIGNhbGxiYWNrIC0+XG4gICAgdC5hZGRfYmVmb3JlX2FkdmFuY2UgPC0gKGF0LCBjYWxsYmFjaykgOjogdC5hZGRfYmVmb3JlX2FkdmFuY2UpXG47O1xuXG5sZXQgc2xlZXAgdCBzcGFuID1cbiAgRWZmZWN0LlByaXZhdGUubWFrZSB+cmVxdWVzdDooKSB+ZXZhbHVhdG9yOihmdW4gY2FsbGJhY2sgLT5cbiAgICBsZXQgYXQgPSBUaW1lX25zLmFkZCAobm93IHQpIHNwYW4gaW5cbiAgICB0LmFkZF9iZWZvcmVfYWR2YW5jZSA8LSAoYXQsIGNhbGxiYWNrKSA6OiB0LmFkZF9iZWZvcmVfYWR2YW5jZSlcbjs7XG5cbmxldCB3YWl0X2FmdGVyX2Rpc3BsYXkgdCA9XG4gIEVmZmVjdC5Qcml2YXRlLm1ha2UgfnJlcXVlc3Q6KCkgfmV2YWx1YXRvcjooZnVuIGNhbGxiYWNrIC0+XG4gICAgdC53YWl0X2FmdGVyX2Rpc3BsYXlfY2FsbGJhY2tzIDwtIGNhbGxiYWNrIDo6IHQud2FpdF9hZnRlcl9kaXNwbGF5X2NhbGxiYWNrcylcbjs7XG5cbm1vZHVsZSBQcml2YXRlID0gc3RydWN0XG4gIGxldCBmbHVzaCB0ID1cbiAgICBsZXQgaGFuZGxlX2ZpcmVkIGNhbGxiYWNrID1cbiAgICAgIEVmZmVjdC5FeHBlcnQuaGFuZGxlXG4gICAgICAgIChFZmZlY3QuUHJpdmF0ZS5DYWxsYmFjay5yZXNwb25kX3RvXG4gICAgICAgICAgIChUaW1pbmdfd2hlZWwuQWxhcm0udmFsdWUgdC50aW1pbmdfd2hlZWwgY2FsbGJhY2spXG4gICAgICAgICAgICgpKVxuICAgIGluXG4gICAgTGlzdC5pdGVyIChSZXZlcnNlZF9saXN0LnJldiB0LmFkZF9iZWZvcmVfYWR2YW5jZSkgfmY6KGZ1biAoYXQsIGNhbGxiYWNrKSAtPlxuICAgICAgbGV0IChfIDogXyBUaW1pbmdfd2hlZWwuQWxhcm0udCkgPSBUaW1pbmdfd2hlZWwuYWRkIHQudGltaW5nX3doZWVsIH5hdCBjYWxsYmFjayBpblxuICAgICAgKCkpO1xuICAgIHQuYWRkX2JlZm9yZV9hZHZhbmNlIDwtIFtdO1xuICAgIChtYXRjaCB0LmFkdmFuY2VfdG8gd2l0aFxuICAgICB8IFNvbWUgdG9fIC0+XG4gICAgICAgdC5hZHZhbmNlX3RvIDwtIE5vbmU7XG4gICAgICAgVGltaW5nX3doZWVsLmFkdmFuY2VfY2xvY2sgdC50aW1pbmdfd2hlZWwgfnRvXyB+aGFuZGxlX2ZpcmVkO1xuICAgICAgIFRpbWluZ193aGVlbC5maXJlX3Bhc3RfYWxhcm1zIHQudGltaW5nX3doZWVsIH5oYW5kbGVfZmlyZWQ7XG4gICAgICAgSW5jci5DbG9jay5hZHZhbmNlX2Nsb2NrIHQuaW5jciB+dG9fXG4gICAgIHwgTm9uZSAtPiBUaW1pbmdfd2hlZWwuZmlyZV9wYXN0X2FsYXJtcyB0LnRpbWluZ193aGVlbCB+aGFuZGxlX2ZpcmVkKTtcbiAgICBpbnZhcmlhbnQgdFxuICA7O1xuXG4gIGxldCB0cmlnZ2VyX2FmdGVyX2Rpc3BsYXkgdCA9XG4gICAgbGV0IGNhbGxiYWNrcyA9IHQud2FpdF9hZnRlcl9kaXNwbGF5X2NhbGxiYWNrcyBpblxuICAgIHQud2FpdF9hZnRlcl9kaXNwbGF5X2NhbGxiYWNrcyA8LSBbXTtcbiAgICBMaXN0Lml0ZXIgKFJldmVyc2VkX2xpc3QucmV2IGNhbGxiYWNrcykgfmY6KGZ1biBjYWxsYmFjayAtPlxuICAgICAgRWZmZWN0LkV4cGVydC5oYW5kbGUgKEVmZmVjdC5Qcml2YXRlLkNhbGxiYWNrLnJlc3BvbmRfdG8gY2FsbGJhY2sgKCkpKVxuICA7O1xuXG4gIGxldCBoYXNfYWZ0ZXJfZGlzcGxheV9ldmVudHMgdCA9XG4gICAgbm90IChSZXZlcnNlZF9saXN0LmlzX2VtcHR5IHQud2FpdF9hZnRlcl9kaXNwbGF5X2NhbGxiYWNrcylcbiAgOztcbmVuZFxuIl19
