// Generated by js_of_ocaml
//# buildInfo:effects=false, kind=cma, use-js-string=true, version=5.6.0

//# unitInfo: Provides: Polling_state_rpc__
(function
  (globalThis){
   "use strict";
   var
    runtime = globalThis.jsoo_runtime,
    Polling_state_rpc = [0],
    Polling_state_rpc$0 = [0, Polling_state_rpc];
   runtime.caml_register_global(0, Polling_state_rpc$0, "Polling_state_rpc__");
   return;
  }
  (globalThis));

//# unitInfo: Provides: Polling_state_rpc__Bus_state
//# unitInfo: Requires: Async_kernel__Deferred, Async_kernel__Ivar, Bus, Ppx_bench_lib__Benchmark_accumulator, Ppx_expect_runtime, Ppx_inline_test_lib, Ppx_module_timer_runtime
(function
  (globalThis){
   "use strict";
   var
    runtime = globalThis.jsoo_runtime,
    cst_Polling_state_rpc_Bus_stat$0 = "Polling_state_rpc__Bus_state",
    cst_polling_state_rpc$0 = "polling_state_rpc",
    cst_src_bus_state_ml = "src/bus_state.ml";
   function caml_call1(f, a0){
    return (f.l >= 0 ? f.l : f.l = f.length) == 1
            ? f(a0)
            : runtime.caml_call_gen(f, [a0]);
   }
   function caml_call2(f, a0, a1){
    return (f.l >= 0 ? f.l : f.l = f.length) == 2
            ? f(a0, a1)
            : runtime.caml_call_gen(f, [a0, a1]);
   }
   function caml_call6(f, a0, a1, a2, a3, a4, a5){
    return (f.l >= 0 ? f.l : f.l = f.length) == 6
            ? f(a0, a1, a2, a3, a4, a5)
            : runtime.caml_call_gen(f, [a0, a1, a2, a3, a4, a5]);
   }
   var
    global_data = runtime.caml_get_global_data(),
    Bus = global_data.Bus,
    Async_kernel_Ivar = global_data.Async_kernel__Ivar,
    Async_kernel_Deferred = global_data.Async_kernel__Deferred,
    Ppx_module_timer_runtime = global_data.Ppx_module_timer_runtime,
    Ppx_bench_lib_Benchmark_accumu =
      global_data.Ppx_bench_lib__Benchmark_accumulator,
    Ppx_expect_runtime = global_data.Ppx_expect_runtime,
    Ppx_inline_test_lib = global_data.Ppx_inline_test_lib;
   caml_call1(Ppx_module_timer_runtime[4], cst_Polling_state_rpc_Bus_stat$0);
   caml_call1(Ppx_bench_lib_Benchmark_accumu[1][1], cst_polling_state_rpc$0);
   caml_call1(Ppx_expect_runtime[1][1], cst_src_bus_state_ml);
   caml_call2(Ppx_inline_test_lib[6], cst_polling_state_rpc$0, "bus_state.ml");
   var
    _a_ = [0, cst_src_bus_state_ml, 49, 977, 1018],
    cst_polling_state_rpc = cst_polling_state_rpc$0,
    cst_Polling_state_rpc_Bus_stat = cst_Polling_state_rpc_Bus_stat$0;
   function create(param){return [0, 0, function(param){return 0;}];}
   function take(t){
    var match = t[1];
    if(typeof match === "number"){
     var ivar = caml_call1(Async_kernel_Ivar[12], 0);
     t[1] = [0, ivar];
     return caml_call1(Async_kernel_Ivar[19], ivar);
    }
    if(0 === match[0]){
     var ivar$0 = match[1];
     return caml_call1(Async_kernel_Ivar[19], ivar$0);
    }
    var value = match[1];
    t[1] = 0;
    return caml_call1(Async_kernel_Deferred[12], value);
   }
   function unsubscribe(t){
    var unsubscribe = t[2];
    t[1] = 0;
    t[2] = function(param){return 0;};
    return caml_call1(unsubscribe, 0);
   }
   function subscribe(t, bus){
    unsubscribe(t);
    function _b_(response){
     var match = t[1];
     if(typeof match === "number" || ! (0 === match[0]))
      var _c_ = [1, response];
     else{
      var ivar = match[1];
      caml_call2(Async_kernel_Ivar[14], ivar, response);
      var _c_ = 0;
     }
     t[1] = _c_;
     return 0;
    }
    var subscriber = caml_call6(Bus[19], 0, 0, 0, bus, _a_, _b_);
    t[2] = function(param){return caml_call2(Bus[23], bus, subscriber);};
    return 0;
   }
   caml_call1(Ppx_inline_test_lib[7], cst_polling_state_rpc);
   caml_call1(Ppx_expect_runtime[1][2], 0);
   caml_call1(Ppx_bench_lib_Benchmark_accumu[1][2], 0);
   caml_call1(Ppx_module_timer_runtime[5], cst_Polling_state_rpc_Bus_stat);
   var
    Polling_state_rpc_Bus_state = [0, create, take, unsubscribe, subscribe];
   runtime.caml_register_global
    (15, Polling_state_rpc_Bus_state, cst_Polling_state_rpc_Bus_stat$0);
   return;
  }
  (globalThis));

//# unitInfo: Provides: Polling_state_rpc
//# unitInfo: Requires: Async_kernel, Async_kernel__Deferred, Async_kernel__Deferred_or_error, Async_kernel__Ivar, Async_kernel__Throttle, Async_rpc_kernel__Rpc, Base__Exn, Bin_prot__Common, Bin_prot__Read, Bin_prot__Shape, Bin_prot__Write, Bin_shape, Bus, Core, Core__Bag, Core__Error, Core__Hashtbl, Core__Option, Core__Or_error, Core__Sexp, Core__Unique_id, Eager_deferred, Expect_test_config, Inline_test_config, Polling_state_rpc__Bus_state, Ppx_bench_lib__Benchmark_accumulator, Ppx_expect_runtime, Ppx_expect_runtime__Test_block, Ppx_expect_runtime__Test_node, Ppx_expect_runtime__Types, Ppx_inline_test_lib, Ppx_module_timer_runtime, Sexplib0__Sexp_conv, Stdlib
(function
  (globalThis){
   "use strict";
   var
    runtime = globalThis.jsoo_runtime,
    cst = "",
    cst_BUG$3 = "BUG",
    cst_Fresh$0 = "Fresh",
    cst_Polling_state_rpc$0 = "Polling_state_rpc",
    cst_Update$0 = "Update",
    cst_pair$1 = "pair",
    cst_polling_state_rpc$0 = "polling_state_rpc",
    cst_query$2 = "query",
    cst_response$4 = "response",
    cst_rpc_name = "rpc_name",
    cst_rpc_version = "rpc_version",
    cst_src_polling_state_rpc_ml$2 = "src/polling_state_rpc.ml",
    cst_src_polling_state_rpc_ml_R$2 =
      "src/polling_state_rpc.ml.Request.Stable.t",
    cst_src_polling_state_rpc_ml_R$1 =
      "src/polling_state_rpc.ml.Response.pair",
    cst_t$3 = "t",
    cst_update$3 = "update";
   function caml_call1(f, a0){
    return (f.l >= 0 ? f.l : f.l = f.length) == 1
            ? f(a0)
            : runtime.caml_call_gen(f, [a0]);
   }
   function caml_call2(f, a0, a1){
    return (f.l >= 0 ? f.l : f.l = f.length) == 2
            ? f(a0, a1)
            : runtime.caml_call_gen(f, [a0, a1]);
   }
   function caml_call3(f, a0, a1, a2){
    return (f.l >= 0 ? f.l : f.l = f.length) == 3
            ? f(a0, a1, a2)
            : runtime.caml_call_gen(f, [a0, a1, a2]);
   }
   function caml_call4(f, a0, a1, a2, a3){
    return (f.l >= 0 ? f.l : f.l = f.length) == 4
            ? f(a0, a1, a2, a3)
            : runtime.caml_call_gen(f, [a0, a1, a2, a3]);
   }
   function caml_call5(f, a0, a1, a2, a3, a4){
    return (f.l >= 0 ? f.l : f.l = f.length) == 5
            ? f(a0, a1, a2, a3, a4)
            : runtime.caml_call_gen(f, [a0, a1, a2, a3, a4]);
   }
   function caml_call14
   (f, a0, a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11, a12, a13){
    return (f.l >= 0 ? f.l : f.l = f.length) == 14
            ? f(a0, a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11, a12, a13)
            : runtime.caml_call_gen
              (f,
               [a0, a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11, a12, a13]);
   }
   var
    undef = undefined,
    global_data = runtime.caml_get_global_data(),
    tag = "exception thrown from inside of polling-state-rpc bus handler",
    Core_Sexp = global_data.Core__Sexp,
    Core_Error = global_data.Core__Error,
    Core = global_data.Core,
    Sexplib0_Sexp_conv = global_data.Sexplib0__Sexp_conv,
    Bus = global_data.Bus,
    Async_kernel_Throttle = global_data.Async_kernel__Throttle,
    Core_Or_error = global_data.Core__Or_error,
    Async_kernel = global_data.Async_kernel,
    Async_kernel_Deferred_or_error =
      global_data.Async_kernel__Deferred_or_error,
    Async_kernel_Deferred = global_data.Async_kernel__Deferred,
    Async_rpc_kernel_Rpc = global_data.Async_rpc_kernel__Rpc,
    Polling_state_rpc_Bus_state = global_data.Polling_state_rpc__Bus_state,
    Core_Option = global_data.Core__Option,
    Eager_deferred = global_data.Eager_deferred,
    Stdlib = global_data.Stdlib,
    Base_Exn = global_data.Base__Exn,
    Bin_prot_Shape = global_data.Bin_prot__Shape,
    Bin_shape = global_data.Bin_shape,
    Ppx_expect_runtime_Types = global_data.Ppx_expect_runtime__Types,
    Bin_prot_Read = global_data.Bin_prot__Read,
    Bin_prot_Common = global_data.Bin_prot__Common,
    Bin_prot_Write = global_data.Bin_prot__Write,
    Async_kernel_Ivar = global_data.Async_kernel__Ivar,
    Core_Hashtbl = global_data.Core__Hashtbl,
    Core_Bag = global_data.Core__Bag,
    Ppx_module_timer_runtime = global_data.Ppx_module_timer_runtime,
    Ppx_bench_lib_Benchmark_accumu =
      global_data.Ppx_bench_lib__Benchmark_accumulator,
    Ppx_expect_runtime = global_data.Ppx_expect_runtime,
    Ppx_inline_test_lib = global_data.Ppx_inline_test_lib,
    Core_Unique_id = global_data.Core__Unique_id,
    Expect_test_config = global_data.Expect_test_config,
    Ppx_expect_runtime_Test_block = global_data.Ppx_expect_runtime__Test_block,
    Ppx_expect_runtime_Test_node = global_data.Ppx_expect_runtime__Test_node,
    Inline_test_config = global_data.Inline_test_config;
   caml_call1(Ppx_module_timer_runtime[4], cst_Polling_state_rpc$0);
   caml_call1(Ppx_bench_lib_Benchmark_accumu[1][1], cst_polling_state_rpc$0);
   caml_call1(Ppx_expect_runtime[1][1], cst_src_polling_state_rpc_ml$2);
   caml_call2
    (Ppx_inline_test_lib[6], cst_polling_state_rpc$0, "polling_state_rpc.ml");
   var
    include = caml_call1(Core_Unique_id[1], 0),
    bin_size_t = include[1],
    bin_write_t = include[2],
    bin_read_t = include[3],
    bin_shape_t = include[5],
    equal = include[19],
    of_int_exn = include[41],
    create = include[45],
    forget = caml_call1(of_int_exn, -1),
    Query_dispatch_id = caml_call1(Core_Unique_id[1], 0),
    Client_id = caml_call1(Core_Unique_id[1], 0),
    _X_ = [0, cst_Fresh$0],
    _Y_ = [0, cst_Update$0],
    cst_received_an_update_without =
      "received an update without receiving any previous values",
    cst_src_polling_state_rpc_ml_5$0 = "src/polling_state_rpc.ml:567:21",
    cst_BUG$2 = cst_BUG$3,
    _U_ = [0, cst_src_polling_state_rpc_ml$2, 572, 21105, 21113],
    _V_ = [0, 1],
    _W_ = [0, 1],
    cst_Regular_response_caused_by =
      "Regular response caused by forget request. This can also happen if the server is old and does not support forget requests, in which case this is not a bug.",
    cst_src_polling_state_rpc_ml_5 = "src/polling_state_rpc.ml:547:16",
    cst_BUG$1 = cst_BUG$3,
    _S_ = [0, 1],
    _T_ = [0, 0],
    cst_redispatch_called_before_a =
      "[redispatch] called before a query was set or a regular dispatch had completed",
    cst_Request_aborted = "Request aborted",
    cst_cancellation_caused_by_reg = "cancellation caused by regular request",
    cst_src_polling_state_rpc_ml_4$0 = "src/polling_state_rpc.ml:486:22",
    cst_BUG$0 = cst_BUG$3,
    cst_regular_response_caused_by = "regular response caused by cancellation",
    cst_src_polling_state_rpc_ml_4 = "src/polling_state_rpc.ml:465:27",
    cst_BUG = cst_BUG$3,
    _Q_ = [0, 1],
    _R_ = [0, 0],
    cst_this_request_was_cancelled = "this request was cancelled",
    _O_ = [0, cst_rpc_version],
    _P_ = [0, cst_rpc_name],
    cst_A_polling_state_RPC_client$0 =
      "A polling state RPC client has requested a fresh response, but the server expected it to have the seqnum of the latest diffs. The server will send a fresh response as requested. This likely means that the client had trouble receiving the last RPC response.",
    cst_src_polling_state_rpc_ml_3 = "src/polling_state_rpc.ml:309:16",
    _M_ = [0, cst_rpc_version],
    _N_ = [0, cst_rpc_name],
    cst_A_polling_state_RPC_client =
      "A polling state RPC client has requested diffs from a seqnum that the server does not have, so the server is sending a fresh response instead. This likely means that the client had trouble receiving the last RPC response.",
    cst_src_polling_state_rpc_ml_2 = "src/polling_state_rpc.ml:295:19",
    _L_ = [1, cst_src_polling_state_rpc_ml_R$1],
    cst_src_polling_state_rpc_ml_R$0 = cst_src_polling_state_rpc_ml_R$1,
    cst_pair$0 = cst_pair$1,
    _x_ = [1, "src/polling_state_rpc.ml.Response.t"],
    cst_t$2 = cst_t$3,
    _l_ = [1, cst_src_polling_state_rpc_ml_R$2],
    cst_src_polling_state_rpc_ml_R = cst_src_polling_state_rpc_ml_R$2,
    cst_t$0 = cst_t$3,
    cst_Cancel_ongoing = "Cancel_ongoing",
    cst_client_id = "client_id",
    cst_query = cst_query$2,
    cst_src_polling_state_rpc_ml_1 = "src/polling_state_rpc.ml:136:20",
    cst_query$0 = cst_query$2,
    cst_last_seqnum = "last_seqnum",
    cst_Query = "Query",
    cst_query$1 = cst_query$2,
    cst_t = cst_t$3,
    cst_src_polling_state_rpc_ml_1$0 = "src/polling_state_rpc.ml:133:4",
    _as_ =
      [0,
       [0,
        [0, " 4eb554fadd7eded37e4da89efd208c52 ", [0, cst]],
        [0, 4651, 4666, 4704]]],
    _at_ = [0, 4651, 4657, 4705],
    _ay_ = [0, 4584, 4588, 4705],
    _az_ = [0, 4651, 4705, 4705],
    _aA_ = [0, 4584, 4588, 4705],
    cst_src_polling_state_rpc_ml$1 = cst_src_polling_state_rpc_ml$2,
    cst_update = cst_update$3,
    cst_src_polling_state_rpc_ml_1$1 = "src/polling_state_rpc.ml:167:16",
    cst_Update = cst_Update$0,
    cst_response = cst_response$4,
    cst_src_polling_state_rpc_ml_1$2 = "src/polling_state_rpc.ml:166:15",
    cst_Fresh = cst_Fresh$0,
    cst_update$0 = cst_update$3,
    cst_response$0 = cst_response$4,
    cst_t$1 = cst_t$3,
    cst_src_polling_state_rpc_ml_1$3 = "src/polling_state_rpc.ml:165:2",
    _ai_ =
      [0,
       [0,
        [0, " 13ef8c5223a0ea284c72512be32e5c09 ", [0, cst]],
        [0, 5668, 5681, 5719]]],
    _aj_ = [0, 5668, 5672, 5720],
    _ao_ = [0, 5596, 5598, 5720],
    _ap_ = [0, 5668, 5720, 5720],
    _aq_ = [0, 5596, 5598, 5720],
    cst_src_polling_state_rpc_ml$0 = cst_src_polling_state_rpc_ml$2,
    _y_ = [0, [0, "Cancellation_successful", 0], 0],
    cst_update$1 = cst_update$3,
    cst_src_polling_state_rpc_ml_1$4 = "src/polling_state_rpc.ml:178:33",
    cst_response$1 = cst_response$4,
    cst_src_polling_state_rpc_ml_1$5 = "src/polling_state_rpc.ml:178:22",
    cst_response$2 = cst_response$4,
    cst_new_seqnum = "new_seqnum",
    cst_Response = "Response",
    cst_update$2 = cst_update$3,
    cst_response$3 = cst_response$4,
    cst_pair = cst_pair$1,
    cst_src_polling_state_rpc_ml_1$6 = "src/polling_state_rpc.ml:175:2",
    ___ =
      [0,
       [0,
        [0, " 8bc63a85561d87b693d15e78c64e1008 ", [0, cst]],
        [0, 5994, 6007, 6045]]],
    _$_ = [0, 5994, 5998, 6046],
    _ae_ = [0, 5919, 5921, 6046],
    _af_ = [0, 5994, 6046, 6046],
    _ag_ = [0, 5919, 5921, 6046],
    cst_src_polling_state_rpc_ml = cst_src_polling_state_rpc_ml$2,
    cst_polling_state_rpc = cst_polling_state_rpc$0,
    cst_Polling_state_rpc = cst_Polling_state_rpc$0;
   function find_by_connection(t, connection){
    function _cq_(_ct_){return _ct_[2];}
    function _cr_(param){
     var conn = param[1];
     return connection === conn ? 1 : 0;
    }
    var _cs_ = caml_call2(Core_Bag[15], t, _cr_);
    return caml_call2(Core_Option[34], _cs_, _cq_);
   }
   function find
   (t, connection_state, connection, client_id, create_client_state){
    var match = find_by_connection(t[1], connection);
    if(match)
     var per_connection = match[1], per_connection$0 = per_connection;
    else{
     var
      result = caml_call3(Client_id[38][5], 0, 0, 0),
      elt = caml_call2(Core_Bag[23], t[1], [0, connection, result]),
      _cm_ =
        function(param){
         function _cp_(param){
          var client_state = param[3];
          return caml_call1(t[2], client_state);
         }
         caml_call2(Core_Hashtbl[20], result, _cp_);
         return caml_call2(Core_Bag[26], t[1], elt);
        },
      _cn_ = caml_call1(Async_rpc_kernel_Rpc[5][11], connection);
     caml_call2(Async_kernel_Deferred[4], _cn_, _cm_);
     var per_connection$0 = result;
    }
    function _cl_(param){
     var _co_ = caml_call1(create_client_state, connection_state);
     return [0, 0, caml_call1(Async_kernel_Ivar[12], 0), _co_];
    }
    return caml_call3(Core_Hashtbl[54], per_connection$0, client_id, _cl_);
   }
   function trigger_cancel(per_client){
    caml_call2(Async_kernel_Ivar[14], per_client[2], 0);
    per_client[2] = caml_call1(Async_kernel_Ivar[12], 0);
    return;
   }
   var
    _a_ = [0, [0, cst_Cancel_ongoing, [0, Client_id[5], 0]], 0],
    _b_ = [0, [0, cst_client_id, Client_id[5]], 0],
    _c_ = caml_call1(Bin_shape[3][1], cst_query),
    _d_ = caml_call1(Bin_shape[4][1], cst_src_polling_state_rpc_ml_1),
    _e_ = [0, [0, cst_query$0, caml_call2(Bin_prot_Shape[11], _d_, _c_)], _b_],
    _f_ = [0, [0, cst_last_seqnum, caml_call1(Core[499], bin_shape_t)], _e_],
    _g_ = [0, [0, cst_Query, [0, caml_call1(Bin_prot_Shape[4], _f_), 0]], _a_],
    _h_ = caml_call1(Bin_prot_Shape[5], _g_),
    _i_ = [0, caml_call1(Bin_shape[3][1], cst_query$1), 0],
    _j_ = [0, [0, caml_call1(Bin_shape[2][1], cst_t), _i_, _h_], 0],
    _k_ = caml_call1(Bin_shape[4][1], cst_src_polling_state_rpc_ml_1$0),
    group = caml_call2(Bin_prot_Shape[2], _k_, _j_);
   function bin_shape_t$0(query){
    var _ck_ = caml_call1(Bin_shape[2][1], cst_t$0);
    return caml_call1
            (caml_call2(Bin_prot_Shape[10], group, _ck_), [0, query, 0]);
   }
   if(typeof Ppx_inline_test_lib[3] !== "number"){
    var
     Ppx_expect_test_block$1 =
       caml_call1(Ppx_expect_runtime_Test_block[1], Expect_test_config),
     _ar_ =
       function(param){
        var
         _cg_ = bin_shape_t$0(Core[603]),
         _ch_ = caml_call1(Bin_prot_Shape[15], _cg_),
         _ci_ = caml_call1(Bin_shape[19][4], _ch_);
        caml_call1(Core[32], _ci_);
        var _cj_ = caml_call1(Ppx_expect_runtime_Types[4][1], 0);
        return caml_call1(Ppx_expect_test_block$1[2], _cj_);
       },
     _au_ =
       caml_call3
        (Ppx_expect_runtime_Test_node[1][1],
         [0, Ppx_expect_runtime_Types[1][1]],
         _at_,
         _as_),
     _av_ = [0, [0, caml_call1(Ppx_expect_runtime_Types[4][1], 0), _au_], 0],
     _aw_ = caml_call1(Ppx_expect_runtime_Types[4][1], 2),
     _ax_ = caml_call1(Ppx_expect_runtime_Types[4][1], 1);
    caml_call14
     (Ppx_expect_test_block$1[3],
      cst_src_polling_state_rpc_ml$1,
      142,
      _aA_,
      _az_,
      _ay_,
      [0, Ppx_expect_runtime_Types[1][1]],
      0,
      _ax_,
      _aw_,
      0,
      0,
      Inline_test_config,
      _av_,
      _ar_);
   }
   var
    _m_ = caml_call1(Bin_shape[3][1], cst_update),
    _n_ = caml_call1(Bin_shape[4][1], cst_src_polling_state_rpc_ml_1$1),
    _o_ =
      [0,
       [0, cst_Update, [0, caml_call2(Bin_prot_Shape[11], _n_, _m_), 0]],
       0],
    _p_ = caml_call1(Bin_shape[3][1], cst_response),
    _q_ = caml_call1(Bin_shape[4][1], cst_src_polling_state_rpc_ml_1$2),
    _r_ =
      [0,
       [0, cst_Fresh, [0, caml_call2(Bin_prot_Shape[11], _q_, _p_), 0]],
       _o_],
    _s_ = caml_call1(Bin_prot_Shape[5], _r_),
    _t_ = [0, caml_call1(Bin_shape[3][1], cst_update$0), 0],
    _u_ = [0, caml_call1(Bin_shape[3][1], cst_response$0), _t_],
    _v_ = [0, [0, caml_call1(Bin_shape[2][1], cst_t$1), _u_, _s_], 0],
    _w_ = caml_call1(Bin_shape[4][1], cst_src_polling_state_rpc_ml_1$3),
    group$0 = caml_call2(Bin_prot_Shape[2], _w_, _v_);
   function bin_shape_t$1(response, update){
    var _cf_ = caml_call1(Bin_shape[2][1], cst_t$2);
    return caml_call1
            (caml_call2(Bin_prot_Shape[10], group$0, _cf_),
             [0, response, [0, update, 0]]);
   }
   if(typeof Ppx_inline_test_lib[3] !== "number"){
    var
     Ppx_expect_test_block$0 =
       caml_call1(Ppx_expect_runtime_Test_block[1], Expect_test_config),
     _ah_ =
       function(param){
        var
         _ce_ = bin_shape_t$1(Core[372], Core[541]),
         _cb_ = caml_call1(Bin_prot_Shape[15], _ce_),
         _cc_ = caml_call1(Bin_shape[19][4], _cb_);
        caml_call1(Core[32], _cc_);
        var _cd_ = caml_call1(Ppx_expect_runtime_Types[4][1], 3);
        return caml_call1(Ppx_expect_test_block$0[2], _cd_);
       },
     _ak_ =
       caml_call3
        (Ppx_expect_runtime_Test_node[1][1],
         [0, Ppx_expect_runtime_Types[1][1]],
         _aj_,
         _ai_),
     _al_ = [0, [0, caml_call1(Ppx_expect_runtime_Types[4][1], 3), _ak_], 0],
     _am_ = caml_call1(Ppx_expect_runtime_Types[4][1], 5),
     _an_ = caml_call1(Ppx_expect_runtime_Types[4][1], 4);
    caml_call14
     (Ppx_expect_test_block$0[3],
      cst_src_polling_state_rpc_ml$0,
      170,
      _aq_,
      _ap_,
      _ao_,
      [0, Ppx_expect_runtime_Types[1][1]],
      0,
      _an_,
      _am_,
      0,
      0,
      Inline_test_config,
      _al_,
      _ah_);
   }
   var
    _z_ = caml_call1(Bin_shape[3][1], cst_update$1),
    _A_ = caml_call1(Bin_shape[4][1], cst_src_polling_state_rpc_ml_1$4),
    _B_ = caml_call2(Bin_prot_Shape[11], _A_, _z_),
    _C_ = caml_call1(Bin_shape[3][1], cst_response$1),
    _D_ = caml_call1(Bin_shape[4][1], cst_src_polling_state_rpc_ml_1$5),
    _E_ =
      [0,
       [0, cst_new_seqnum, bin_shape_t],
       [0,
        [0,
         cst_response$2,
         bin_shape_t$1(caml_call2(Bin_prot_Shape[11], _D_, _C_), _B_)],
        0]],
    _F_ =
      [0, [0, cst_Response, [0, caml_call1(Bin_prot_Shape[4], _E_), 0]], _y_],
    _G_ = caml_call1(Bin_prot_Shape[5], _F_),
    _H_ = [0, caml_call1(Bin_shape[3][1], cst_update$2), 0],
    _I_ = [0, caml_call1(Bin_shape[3][1], cst_response$3), _H_],
    _J_ = [0, [0, caml_call1(Bin_shape[2][1], cst_pair), _I_, _G_], 0],
    _K_ = caml_call1(Bin_shape[4][1], cst_src_polling_state_rpc_ml_1$6),
    group$1 = caml_call2(Bin_prot_Shape[2], _K_, _J_);
   function bin_shape_pair(response, update){
    var _ca_ = caml_call1(Bin_shape[2][1], cst_pair$0);
    return caml_call1
            (caml_call2(Bin_prot_Shape[10], group$1, _ca_),
             [0, response, [0, update, 0]]);
   }
   if(typeof Ppx_inline_test_lib[3] !== "number"){
    var
     Ppx_expect_test_block =
       caml_call1(Ppx_expect_runtime_Test_block[1], Expect_test_config),
     _Z_ =
       function(param){
        var
         _b$_ = bin_shape_pair(Core[372], Core[541]),
         _b8_ = caml_call1(Bin_prot_Shape[15], _b$_),
         _b9_ = caml_call1(Bin_shape[19][4], _b8_);
        caml_call1(Core[32], _b9_);
        var _b__ = caml_call1(Ppx_expect_runtime_Types[4][1], 6);
        return caml_call1(Ppx_expect_test_block[2], _b__);
       },
     _aa_ =
       caml_call3
        (Ppx_expect_runtime_Test_node[1][1],
         [0, Ppx_expect_runtime_Types[1][1]],
         _$_,
         ___),
     _ab_ = [0, [0, caml_call1(Ppx_expect_runtime_Types[4][1], 6), _aa_], 0],
     _ac_ = caml_call1(Ppx_expect_runtime_Types[4][1], 8),
     _ad_ = caml_call1(Ppx_expect_runtime_Types[4][1], 7);
    caml_call14
     (Ppx_expect_test_block[3],
      cst_src_polling_state_rpc_ml,
      183,
      _ag_,
      _af_,
      _ae_,
      [0, Ppx_expect_runtime_Types[1][1]],
      0,
      _ad_,
      _ac_,
      0,
      0,
      Inline_test_config,
      _ab_,
      _Z_);
   }
   function name(param){
    var underlying_rpc = param[3];
    return caml_call1(Async_rpc_kernel_Rpc[6][2], underlying_rpc);
   }
   function version(param){
    var underlying_rpc = param[3];
    return caml_call1(Async_rpc_kernel_Rpc[6][3], underlying_rpc);
   }
   function babel_generic_rpc(param){
    var underlying_rpc = param[3];
    return [0, underlying_rpc];
   }
   function create$0(name, version, query_equal, bin_query$0, M){
    var
     bin_update = M[9][8],
     bin_response$0 = M[8],
     bin_reader_update = bin_update[3],
     bin_reader_response = bin_response$0[3];
    function _bY_(buf, pos_ref, vtag){
     return caml_call2
             (Bin_prot_Common[19],
              cst_src_polling_state_rpc_ml_R$0,
              pos_ref[1]);
    }
    var
     _bZ_ =
       [0,
        function(buf, pos_ref){
         var
          of_update = bin_reader_update[1],
          of_response = bin_reader_response[1],
          match$0 = caml_call2(Bin_prot_Read[29], buf, pos_ref);
         if(0 !== match$0)
          return 1 === match$0
                  ? 0
                  : caml_call2(Bin_prot_Common[18], _L_, pos_ref[1]);
         var
          v_new_seqnum = caml_call2(bin_read_t, buf, pos_ref),
          match = caml_call2(Bin_prot_Read[29], buf, pos_ref);
         if(0 === match)
          var
           arg_1 = caml_call2(of_response, buf, pos_ref),
           v_response = [0, arg_1];
         else if(1 === match)
          var
           arg_1$0 = caml_call2(of_update, buf, pos_ref),
           v_response = [1, arg_1$0];
         else
          var v_response = caml_call2(Bin_prot_Common[18], _x_, pos_ref[1]);
         return [0, v_new_seqnum, v_response];
        },
        _bY_],
     bin_writer_update = bin_update[2],
     bin_writer_response = bin_response$0[2];
    function _bW_(buf){
     var
      write_update = bin_writer_update[2],
      write_response = bin_writer_response[2];
     return function(pos$3, param){
      if(! param) return caml_call3(Bin_prot_Write[30], buf, pos$3, 1);
      var
       v2 = param[2],
       v1$1 = param[1],
       pos$1 = caml_call3(Bin_prot_Write[30], buf, pos$3, 0),
       pos$2 = caml_call3(bin_write_t, buf, pos$1, v1$1);
      if(0 === v2[0]){
       var v1 = v2[1], pos = caml_call3(Bin_prot_Write[30], buf, pos$2, 0);
       return caml_call3(write_response, buf, pos, v1);
      }
      var v1$0 = v2[1], pos$0 = caml_call3(Bin_prot_Write[30], buf, pos$2, 1);
      return caml_call3(write_update, buf, pos$0, v1$0);};
    }
    var
     _bX_ =
       [0,
        function(v){
         var
          size_of_update = bin_writer_update[1],
          size_of_response = bin_writer_response[1];
         if(! v) return 1;
         var
          v2 = v[2],
          v1$1 = v[1],
          _b6_ = caml_call1(bin_size_t, v1$1),
          size = caml_call2(Bin_prot_Common[23], 1, _b6_);
         if(0 === v2[0])
          var
           v1 = v2[1],
           _b4_ = caml_call1(size_of_response, v1),
           _b7_ = caml_call2(Bin_prot_Common[23], 1, _b4_);
         else
          var
           v1$0 = v2[1],
           _b5_ = caml_call1(size_of_update, v1$0),
           _b7_ = caml_call2(Bin_prot_Common[23], 1, _b5_);
         return caml_call2(Bin_prot_Common[23], size, _b7_);
        },
        _bW_],
     bin_response =
       [0, bin_shape_pair(bin_response$0[1], bin_update[1]), _bX_, _bZ_],
     bin_reader_query = bin_query$0[3];
    function _bU_(buf, pos_ref, vtag){
     return caml_call2
             (Bin_prot_Common[19], cst_src_polling_state_rpc_ml_R, pos_ref[1]);
    }
    var
     _bV_ =
       [0,
        function(buf, pos_ref){
         var
          of_query = bin_reader_query[1],
          match = caml_call2(Bin_prot_Read[29], buf, pos_ref);
         if(0 === match){
          var
           v_last_seqnum =
             caml_call2(caml_call1(Core[505], bin_read_t), buf, pos_ref),
           v_query = caml_call2(of_query, buf, pos_ref),
           v_client_id = caml_call2(Client_id[3], buf, pos_ref);
          return [0, v_last_seqnum, v_query, v_client_id];
         }
         if(1 !== match)
          return caml_call2(Bin_prot_Common[18], _l_, pos_ref[1]);
         var arg_1 = caml_call2(Client_id[3], buf, pos_ref);
         return [1, arg_1];
        },
        _bU_],
     bin_writer_query = bin_query$0[2];
    function _bS_(buf){
     var write_query = bin_writer_query[2];
     return function(pos$3, param){
      if(0 === param[0]){
       var
        v3 = param[3],
        v2 = param[2],
        v1 = param[1],
        pos = caml_call3(Bin_prot_Write[30], buf, pos$3, 0),
        pos$0 = caml_call4(Core[502], bin_write_t, buf, pos, v1),
        pos$1 = caml_call3(write_query, buf, pos$0, v2);
       return caml_call3(Client_id[2], buf, pos$1, v3);
      }
      var
       v1$0 = param[1],
       pos$2 = caml_call3(Bin_prot_Write[30], buf, pos$3, 1);
      return caml_call3(Client_id[2], buf, pos$2, v1$0);};
    }
    var
     _bT_ =
       [0,
        function(v){
         var size_of_query = bin_writer_query[1];
         if(0 === v[0]){
          var
           v3 = v[3],
           v2 = v[2],
           v1 = v[1],
           _b0_ = caml_call2(Core[500], bin_size_t, v1),
           size = caml_call2(Bin_prot_Common[23], 1, _b0_),
           _b1_ = caml_call1(size_of_query, v2),
           size$0 = caml_call2(Bin_prot_Common[23], size, _b1_),
           _b2_ = caml_call1(Client_id[1], v3);
          return caml_call2(Bin_prot_Common[23], size$0, _b2_);
         }
         var v1$0 = v[1], _b3_ = caml_call1(Client_id[1], v1$0);
         return caml_call2(Bin_prot_Common[23], 1, _b3_);
        },
        _bS_],
     bin_query = [0, bin_shape_t$0(bin_query$0[1]), _bT_, _bV_];
    return [0,
            M,
            query_equal,
            caml_call5
             (Async_rpc_kernel_Rpc[6][1],
              name,
              version,
              bin_query,
              bin_response,
              0)];
   }
   function implement_with_client_state
   (on_client_and_server_out_of_sy,
    create_client_state,
    opt,
    for_first_request,
    t,
    f){
    if(opt)
     var sth = opt[1], on_client_forgotten = sth;
    else
     var on_client_forgotten = function(_bR_){return 0;};
    var
     underlying_rpc = t[3],
     query_equal = t[2],
     response_module = t[1],
     for_first_request$0 = caml_call2(Core_Option[39], for_first_request, f),
     cache = [0, caml_call1(Core_Bag[22], 0), on_client_forgotten];
    function _bo_(param, request){
     var connection = param[2], connection_state = param[1];
     a:
     if(0 === request[0]){
      var last_seqnum = request[1];
      if(last_seqnum){
       var
        client_id = request[3],
        query = request[2],
        last_seqnum$0 = last_seqnum[1];
       if(caml_call2(equal, last_seqnum$0, forget)){var match = [2, query, client_id]; break a;
       }
      }
      var
       client_id$0 = request[3],
       query$0 = request[2],
       match = [0, last_seqnum, query$0, client_id$0];
     }
     else
      var client_id$1 = request[1], match = [1, client_id$1];
     switch(match[0]){
       case 0:
        var
         client_id$2 = match[3],
         query$1 = match[2],
         last_seqnum$1 = match[1],
         per_client =
           find
            (cache,
             connection_state,
             connection,
             client_id$2,
             create_client_state),
         match$0 = per_client[1];
        if(match$0){
         var _by_ = match$0[1], prev_seqnum = _by_[2], prev = _by_[1];
         if(last_seqnum$1){
          var last_seqnum$2 = last_seqnum$1[1];
          if(caml_call2(equal, prev_seqnum, last_seqnum$2))
           var _bz_ = [0, prev];
          else{
           var
            rpc_name = caml_call1(Async_rpc_kernel_Rpc[6][2], underlying_rpc),
            rpc_version =
              caml_call1(Async_rpc_kernel_Rpc[6][3], underlying_rpc),
            _bJ_ =
              [0,
               [1, [0, _M_, [0, caml_call1(Core[389], rpc_version), 0]]],
               0],
            _bK_ =
              [0,
               [1, [0, _N_, [0, caml_call1(Core[558], rpc_name), 0]]],
               _bJ_],
            _bL_ =
              [0,
               caml_call1
                (Sexplib0_Sexp_conv[7], cst_A_polling_state_RPC_client),
               _bK_];
           caml_call1
            (on_client_and_server_out_of_sy,
             [1,
              [0,
               caml_call1
                (Sexplib0_Sexp_conv[7], cst_src_polling_state_rpc_ml_2),
               _bL_]]);
           var _bz_ = 0;
          }
          var _bA_ = _bz_;
         }
         else{
          var
           rpc_name$0 = caml_call1(Async_rpc_kernel_Rpc[6][2], underlying_rpc),
           rpc_version$0 =
             caml_call1(Async_rpc_kernel_Rpc[6][3], underlying_rpc),
           _bM_ =
             [0,
              [1, [0, _O_, [0, caml_call1(Core[389], rpc_version$0), 0]]],
              0],
           _bN_ =
             [0,
              [1, [0, _P_, [0, caml_call1(Core[558], rpc_name$0), 0]]],
              _bM_],
           _bO_ =
             [0,
              caml_call1
               (Sexplib0_Sexp_conv[7], cst_A_polling_state_RPC_client$0),
              _bN_];
          caml_call1
           (on_client_and_server_out_of_sy,
            [1,
             [0,
              caml_call1
               (Sexplib0_Sexp_conv[7], cst_src_polling_state_rpc_ml_3),
              _bO_]]);
          var _bA_ = 0;
         }
         var prev$0 = _bA_;
        }
        else
         var prev$0 = 0;
        var client_state = per_client[3];
        if(prev$0)
         var
          prev$1 = prev$0[1],
          _bB_ =
            function(param){
             var userdata = param[2], response = param[1];
             return [0, response, userdata];
            },
          prev_response = prev$1[2],
          prev_query = prev$1[1],
          f$0 =
            caml_call2(query_equal, prev_query, query$1)
             ? f
             : for_first_request$0,
          _bv_ =
            function(new$0){
             var diff = caml_call2(response_module[10], prev_response, new$0);
             return [0, [1, diff], new$0];
            },
          _bw_ = caml_call3(f$0, connection_state, client_state, query$1),
          _bx_ = caml_call2(Async_kernel[23][3], _bw_, _bv_),
          response = caml_call2(Async_kernel[23][3], _bx_, _bB_);
        else
         var
          _bI_ =
            function(param){
             var userdata = param[2], response = param[1];
             return [0, [0, response], userdata];
            },
          _bs_ = function(response){return [0, response, response];},
          _bt_ =
            caml_call3
             (for_first_request$0, connection_state, client_state, query$1),
          _bu_ = caml_call2(Async_kernel[23][3], _bt_, _bs_),
          response = caml_call2(Async_kernel[23][3], _bu_, _bI_);
        var
         _bC_ = 0,
         _bD_ = function(param){return -1006147983;},
         _br_ = caml_call1(Async_kernel_Ivar[19], per_client[2]),
         _bE_ = [0, caml_call2(Async_kernel[4], _br_, _bD_), _bC_],
         _bF_ = function(r){return [0, -71406943, r];},
         _bG_ = [0, caml_call2(Async_kernel[4], response, _bF_), _bE_],
         response_or_cancelled = caml_call1(Async_kernel[5], _bG_),
         _bH_ =
           function(param){
            if(typeof param === "number")
             return caml_call1
                     (Base_Exn[6],
                      [0, Stdlib[7], cst_this_request_was_cancelled]);
            var
             match = param[2],
             userdata = match[2],
             response = match[1],
             data = [0, query$1, userdata],
             new_seqnum = caml_call1(create, 0);
            per_client[1] = [0, [0, data, new_seqnum]];
            trigger_cancel(per_client);
            return [0, new_seqnum, response];
           };
        return caml_call2(Async_kernel[23][3], response_or_cancelled, _bH_);
       case 1:
        var
         client_id$3 = match[1],
         per_client$0 =
           find
            (cache,
             connection_state,
             connection,
             client_id$3,
             create_client_state);
        trigger_cancel(per_client$0);
        return caml_call1(Async_kernel[20], 0);
       default:
        var
         client_id$4 = match[2],
         _bp_ =
           function(per_connection){
            function _bP_(per_client){
             caml_call1(cache[2], per_client[3]);
             return caml_call2(Async_kernel_Ivar[14], per_client[2], 0);
            }
            var
             _bQ_ = caml_call2(Core_Hashtbl[64], per_connection, client_id$4);
            return caml_call2(Core_Option[46], _bQ_, _bP_);
           },
         _bq_ = find_by_connection(cache[1], connection);
        caml_call2(Core_Option[46], _bq_, _bp_);
        return caml_call1(Async_kernel[20], 0);
     }
    }
    return caml_call3(Async_rpc_kernel_Rpc[6][10], 0, underlying_rpc, _bo_);
   }
   function implement(on_client_and_server_out_of_sy, for_first_request, t, f){
    function _bm_(f, connection_state, client_state, query){return caml_call2(f, connection_state, query);
    }
    var
     for_first_request$0 =
       caml_call2(Core_Option[34], for_first_request, _bm_);
    function f$0(connection_state, client_state, query){return caml_call2(f, connection_state, query);
    }
    var _bn_ = 0;
    return implement_with_client_state
            (on_client_and_server_out_of_sy,
             function(param){return 0;},
             _bn_,
             for_first_request$0,
             t,
             f$0);
   }
   function implement_via_bus
   (on_client_and_server_out_of_sy,
    create_client_state,
    on_client_forgotten,
    rpc,
    f){
    function _bf_(connection_state, param, query){
     var bus_state = param[1];
     return caml_call1(Polling_state_rpc_Bus_state[2], bus_state);
    }
    var
     _bg_ =
       [0,
        function(connection_state, param, query){
         var client_state = param[2], bus_state = param[1];
         function _bk_(bus){
          caml_call2(Polling_state_rpc_Bus_state[4], bus_state, bus);
          return caml_call1(Polling_state_rpc_Bus_state[2], bus_state);
         }
         var _bl_ = caml_call3(f, connection_state, client_state, query);
         return caml_call2(Eager_deferred[12][4][2], _bl_, _bk_);
        }],
     _bh_ =
       [0,
        function(param){
         var client_state = param[2], bus_state = param[1];
         caml_call1(Polling_state_rpc_Bus_state[3], bus_state);
         function _bj_(on_client_forgotten){
          return caml_call1(on_client_forgotten, client_state);
         }
         return caml_call2(Core_Option[46], on_client_forgotten, _bj_);
        }];
    return implement_with_client_state
            (on_client_and_server_out_of_sy,
             function(connection_state){
              var _bi_ = caml_call1(create_client_state, connection_state);
              return [0, caml_call1(Polling_state_rpc_Bus_state[1], 0), _bi_];
             },
             _bh_,
             _bg_,
             rpc,
             _bf_);
   }
   function implement_via_bus$0
   (on_client_and_server_out_of_sy,
    create_client_state,
    on_client_forgotten,
    rpc,
    f){
    return implement_via_bus
            (on_client_and_server_out_of_sy,
             create_client_state,
             on_client_forgotten,
             rpc,
             function(connection_state, client_state, query){
              var _be_ = caml_call3(f, connection_state, client_state, query);
              return caml_call1(Async_kernel_Deferred[12], _be_);
             });
   }
   function dispatch_underlying(t, connection, request){
    switch(request[0]){
      case 0:
       var
        client_id = request[3],
        query = request[2],
        last_seqnum = request[1],
        _bd_ = [0, last_seqnum, query, client_id];
       break;
      case 1:
       var client_id$0 = request[1], _bd_ = [1, client_id$0]; break;
      default:
       var
        client_id$1 = request[2],
        query$0 = request[1],
        _bd_ = [0, [0, forget], query$0, client_id$1];
    }
    return caml_call3(Async_rpc_kernel_Rpc[6][16], t[11], connection, _bd_);
   }
   function dispatch(t, connection, query){
    t[2] = [0, query];
    function _a9_(response){
     if(0 !== response[0]){
      var e = response[1];
      return caml_call1(Async_kernel[20], [1, e]);
     }
     var match = response[1];
     if(match){
      var
       response$0 = match[2],
       new_seqnum = match[1],
       new_out = caml_call3(t[12], t[4], query, response$0);
      t[1] = [0, new_seqnum];
      t[4] = [0, new_out];
      caml_call3(Bus[14], t[8], query, new_out);
      return caml_call1(Async_kernel[20], [0, new_out]);
     }
     var
      _a$_ =
        [0,
         caml_call1(Sexplib0_Sexp_conv[7], cst_cancellation_caused_by_reg),
         0],
      _ba_ =
        [0,
         caml_call1(Sexplib0_Sexp_conv[7], cst_src_polling_state_rpc_ml_4$0),
         _a$_],
      _bb_ = [1, [0, caml_call1(Sexplib0_Sexp_conv[7], cst_BUG$0), _ba_]],
      _bc_ = caml_call1(Core_Or_error[45], _bb_);
     return caml_call1(Async_kernel[20], _bc_);
    }
    var
     last_seqnum = t[1],
     client_id = t[7],
     _a__ =
       dispatch_underlying(t, connection, [0, last_seqnum, query, client_id]);
    return caml_call2(Async_kernel[23][2], _a__, _a9_);
   }
   function collapse_sequencer_error(param){
    if(typeof param === "number")
     return [1, caml_call1(Core_Error[14], cst_Request_aborted)];
    if(17724 <= param[1]){
     var result_or_error = param[2];
     return result_or_error;
    }
    var exn = param[2];
    return [1, caml_call2(Core_Error[27], 0, exn)];
   }
   function dispatch$0(param, connection, query){
    var
     t = param[1],
     query_dispatch_id = caml_call1(Query_dispatch_id[45], 0);
    t[3] = query_dispatch_id;
    function _aY_(param){
     if(caml_call2(Query_dispatch_id[19], t[3], query_dispatch_id))
      var
       _a7_ = function(param){return dispatch(t, connection, query);},
       _a8_ = caml_call2(Async_kernel_Throttle[9], t[5], _a7_);
     else
      var _a8_ = caml_call1(Async_kernel[20], -216426513);
     return caml_call2(Async_kernel[22], _a8_, collapse_sequencer_error);
    }
    function _aW_(param){
     var match = t[2];
     if(! match) return Async_kernel_Deferred_or_error[37];
     var q = match[1], _aZ_ = caml_call1(Async_kernel_Throttle[18], t[5]);
     if(caml_call2(Core[90], _aZ_, 0))
      return Async_kernel_Deferred_or_error[37];
     if(caml_call2(t[10], query, q))
      return Async_kernel_Deferred_or_error[37];
     caml_call1(Async_kernel_Throttle[21], t[5]);
     function _a0_(cancel_response){
      function _a2_(param){
       t[5] = caml_call3(Async_kernel_Throttle[25][2], 0, _Q_, 0);
       if(0 !== cancel_response[0]){
        var e = cancel_response[1];
        return [1, e];
       }
       if(! cancel_response[1]) return _R_;
       var
        _a4_ =
          [0,
           caml_call1(Sexplib0_Sexp_conv[7], cst_regular_response_caused_by),
           0],
        _a5_ =
          [0,
           caml_call1(Sexplib0_Sexp_conv[7], cst_src_polling_state_rpc_ml_4),
           _a4_],
        _a6_ = [1, [0, caml_call1(Sexplib0_Sexp_conv[7], cst_BUG), _a5_]];
       return caml_call1(Core_Or_error[45], _a6_);
      }
      var _a3_ = caml_call1(Async_kernel_Throttle[24], t[5]);
      return caml_call2(Async_kernel[23][3], _a3_, _a2_);
     }
     var _a1_ = dispatch_underlying(t, connection, [1, t[7]]);
     return caml_call2(Async_kernel[23][2], _a1_, _a0_);
    }
    var _aX_ = caml_call2(Async_kernel_Throttle[10], t[6], _aW_);
    return caml_call2(Async_kernel_Deferred_or_error[19][4][2], _aX_, _aY_);
   }
   function redispatch(param, connection){
    var t = param[1];
    function _aT_(param){
     var match = t[2];
     if(match){var q = match[1]; return dispatch(t, connection, q);}
     var
      _aV_ = [1, caml_call1(Core_Error[14], cst_redispatch_called_before_a)];
     return caml_call1(Async_kernel_Deferred[12], _aV_);
    }
    var _aU_ = caml_call2(Async_kernel_Throttle[9], t[5], _aT_);
    return caml_call2(Async_kernel[22], _aU_, collapse_sequencer_error);
   }
   function forget_on_server(param, connection){
    var t = param[1];
    t[3] = caml_call1(Query_dispatch_id[45], 0);
    var match = t[2];
    if(! match) return Async_kernel_Deferred_or_error[37];
    var query = match[1];
    function _aK_(param){
     caml_call1(Async_kernel_Throttle[21], t[5]);
     function _aM_(forget_response){
      function _aO_(param){
       t[5] = caml_call3(Async_kernel_Throttle[25][2], 0, _S_, 0);
       if(0 !== forget_response[0]){
        var e = forget_response[1];
        return [1, e];
       }
       if(! forget_response[1]) return _T_;
       var
        _aQ_ =
          [0,
           caml_call1(Sexplib0_Sexp_conv[7], cst_Regular_response_caused_by),
           0],
        _aR_ =
          [0,
           caml_call1(Sexplib0_Sexp_conv[7], cst_src_polling_state_rpc_ml_5),
           _aQ_],
        _aS_ = [1, [0, caml_call1(Sexplib0_Sexp_conv[7], cst_BUG$1), _aR_]];
       return caml_call1(Core_Or_error[45], _aS_);
      }
      var _aP_ = caml_call1(Async_kernel_Throttle[24], t[5]);
      return caml_call2(Async_kernel[23][3], _aP_, _aO_);
     }
     var _aN_ = dispatch_underlying(t, connection, [2, query, t[7]]);
     return caml_call2(Async_kernel[23][2], _aN_, _aM_);
    }
    var _aL_ = caml_call2(Async_kernel_Throttle[9], t[6], _aK_);
    return caml_call2(Async_kernel[22], _aL_, collapse_sequencer_error);
   }
   function query(param){var last_query = param[1][2]; return last_query;}
   function bus(param){var bus = param[1][8]; return caml_call1(Bus[6], bus);}
   function create$1(initial_query, t){
    var underlying_rpc = t[3], query_equal = t[2], response_module = t[1];
    function f(prev, query, param){
     if(0 === param[0]){var r = param[1]; return r;}
     var diffs = param[1];
     if(prev){
      var prev$0 = prev[1];
      return caml_call2(response_module[11], prev$0, diffs);
     }
     var
      _aH_ =
        [0,
         caml_call1(Sexplib0_Sexp_conv[7], cst_received_an_update_without),
         0],
      _aI_ =
        [0,
         caml_call1(Sexplib0_Sexp_conv[7], cst_src_polling_state_rpc_ml_5$0),
         _aH_],
      _aJ_ = [1, [0, caml_call1(Sexplib0_Sexp_conv[7], cst_BUG$2), _aI_]];
     return caml_call1(Core[261], _aJ_);
    }
    function _aD_(error){
     var
      _aF_ = caml_call2(Core_Error[22], error, tag),
      _aG_ = caml_call1(Core_Error[9], _aF_);
     return caml_call2(Core[257], 0, _aG_);
    }
    var
     bus = caml_call5(Bus[7], 0, _U_, 2, 1, _aD_),
     sequencer = caml_call3(Async_kernel_Throttle[25][2], 0, _V_, 0),
     cleaning_sequencer = caml_call3(Async_kernel_Throttle[25][2], 0, _W_, 0),
     _aE_ = caml_call1(Client_id[45], 0);
    return [0,
            [0,
             0,
             initial_query,
             caml_call1(Query_dispatch_id[45], 0),
             0,
             sequencer,
             cleaning_sequencer,
             _aE_,
             bus,
             response_module,
             query_equal,
             underlying_rpc,
             f]];
   }
   function sexp_of_t(sexp_of_a, param){
    if(0 === param[0]){
     var a = param[1], _aB_ = caml_call1(sexp_of_a, a);
     return [1, [0, _X_, [0, caml_call1(Core_Sexp[93], _aB_), 0]]];
    }
    var sexp_of = param[2], t = param[1], _aC_ = caml_call1(sexp_of, t);
    return [1, [0, _Y_, [0, caml_call1(Core_Sexp[93], _aC_), 0]]];
   }
   var Response = [0, sexp_of_t];
   function create_client(initial_query, t, introspect){
    var
     client = create$1(initial_query, t)[1],
     response_module = client[9],
     fold = client[12];
    function new_fold(prev, query, resp){
     if(0 === resp[0])
      var r = resp[1], resp$0 = [0, r];
     else
      var diffs = resp[1], resp$0 = [1, diffs, response_module[9][9]];
     caml_call3(introspect, prev, query, resp$0);
     return caml_call3(fold, prev, query, resp);
    }
    return [0,
            [0,
             client[1],
             client[2],
             client[3],
             client[4],
             client[5],
             client[6],
             client[7],
             client[8],
             client[9],
             client[10],
             client[11],
             new_fold]];
   }
   caml_call1(Ppx_inline_test_lib[7], cst_polling_state_rpc);
   caml_call1(Ppx_expect_runtime[1][2], 0);
   caml_call1(Ppx_bench_lib_Benchmark_accumu[1][2], 0);
   caml_call1(Ppx_module_timer_runtime[5], cst_Polling_state_rpc);
   var
    Polling_state_rpc =
      [0,
       name,
       version,
       babel_generic_rpc,
       create$0,
       implement,
       implement_with_client_state,
       implement_via_bus,
       implement_via_bus$0,
       [0, create$1, dispatch$0, redispatch, forget_on_server, query, bus],
       [0, Response, create_client]];
   runtime.caml_register_global
    (135, Polling_state_rpc, cst_Polling_state_rpc$0);
   return;
  }
  (globalThis));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLjAsImZpbGUiOiJwb2xsaW5nX3N0YXRlX3JwYy5jbWEuanMiLCJzb3VyY2VSb290IjoiIiwibmFtZXMiOlsiY3JlYXRlIiwidGFrZSIsInQiLCJpdmFyIiwiaXZhciQwIiwidmFsdWUiLCJ1bnN1YnNjcmliZSIsInN1YnNjcmliZSIsImJ1cyIsInJlc3BvbnNlIiwic3Vic2NyaWJlciIsInRhZyIsImZvcmdldCIsImZpbmRfYnlfY29ubmVjdGlvbiIsImNvbm5lY3Rpb24iLCJjb25uIiwiZmluZCIsImNvbm5lY3Rpb25fc3RhdGUiLCJjbGllbnRfaWQiLCJjcmVhdGVfY2xpZW50X3N0YXRlIiwicGVyX2Nvbm5lY3Rpb24iLCJwZXJfY29ubmVjdGlvbiQwIiwicmVzdWx0IiwiZWx0IiwiY2xpZW50X3N0YXRlIiwidHJpZ2dlcl9jYW5jZWwiLCJwZXJfY2xpZW50IiwiZ3JvdXAiLCJiaW5fc2hhcGVfdCQwIiwicXVlcnkiLCJncm91cCQwIiwiYmluX3NoYXBlX3QkMSIsInVwZGF0ZSIsImdyb3VwJDEiLCJiaW5fc2hhcGVfcGFpciIsIm5hbWUiLCJ1bmRlcmx5aW5nX3JwYyIsInZlcnNpb24iLCJiYWJlbF9nZW5lcmljX3JwYyIsImNyZWF0ZSQwIiwicXVlcnlfZXF1YWwiLCJiaW5fcXVlcnkkMCIsIk0iLCJiaW5fdXBkYXRlIiwiYmluX3Jlc3BvbnNlJDAiLCJiaW5fcmVhZGVyX3VwZGF0ZSIsImJpbl9yZWFkZXJfcmVzcG9uc2UiLCJidWYiLCJwb3NfcmVmIiwidnRhZyIsIm9mX3VwZGF0ZSIsIm9mX3Jlc3BvbnNlIiwidl9uZXdfc2VxbnVtIiwiYXJnXzEiLCJ2X3Jlc3BvbnNlIiwiYXJnXzEkMCIsImJpbl93cml0ZXJfdXBkYXRlIiwiYmluX3dyaXRlcl9yZXNwb25zZSIsIndyaXRlX3VwZGF0ZSIsIndyaXRlX3Jlc3BvbnNlIiwicG9zJDMiLCJ2MiIsInYxJDEiLCJwb3MkMSIsInBvcyQyIiwidjEiLCJwb3MiLCJ2MSQwIiwicG9zJDAiLCJ2Iiwic2l6ZV9vZl91cGRhdGUiLCJzaXplX29mX3Jlc3BvbnNlIiwic2l6ZSIsImJpbl9yZXNwb25zZSIsImJpbl9yZWFkZXJfcXVlcnkiLCJvZl9xdWVyeSIsInZfbGFzdF9zZXFudW0iLCJ2X3F1ZXJ5Iiwidl9jbGllbnRfaWQiLCJiaW5fd3JpdGVyX3F1ZXJ5Iiwid3JpdGVfcXVlcnkiLCJ2MyIsInNpemVfb2ZfcXVlcnkiLCJzaXplJDAiLCJiaW5fcXVlcnkiLCJpbXBsZW1lbnRfd2l0aF9jbGllbnRfc3RhdGUiLCJvbl9jbGllbnRfYW5kX3NlcnZlcl9vdXRfb2Zfc3kiLCJvcHQiLCJmb3JfZmlyc3RfcmVxdWVzdCIsImYiLCJzdGgiLCJvbl9jbGllbnRfZm9yZ290dGVuIiwicmVzcG9uc2VfbW9kdWxlIiwiZm9yX2ZpcnN0X3JlcXVlc3QkMCIsImNhY2hlIiwicmVxdWVzdCIsImxhc3Rfc2VxbnVtIiwibGFzdF9zZXFudW0kMCIsImNsaWVudF9pZCQwIiwicXVlcnkkMCIsImNsaWVudF9pZCQxIiwiY2xpZW50X2lkJDIiLCJxdWVyeSQxIiwibGFzdF9zZXFudW0kMSIsInByZXZfc2VxbnVtIiwicHJldiIsImxhc3Rfc2VxbnVtJDIiLCJycGNfbmFtZSIsInJwY192ZXJzaW9uIiwicnBjX25hbWUkMCIsInJwY192ZXJzaW9uJDAiLCJwcmV2JDAiLCJwcmV2JDEiLCJ1c2VyZGF0YSIsInByZXZfcmVzcG9uc2UiLCJwcmV2X3F1ZXJ5IiwiZiQwIiwibmV3JDAiLCJkaWZmIiwiciIsInJlc3BvbnNlX29yX2NhbmNlbGxlZCIsImRhdGEiLCJuZXdfc2VxbnVtIiwiY2xpZW50X2lkJDMiLCJwZXJfY2xpZW50JDAiLCJjbGllbnRfaWQkNCIsImltcGxlbWVudCIsImltcGxlbWVudF92aWFfYnVzIiwicnBjIiwiYnVzX3N0YXRlIiwiaW1wbGVtZW50X3ZpYV9idXMkMCIsImRpc3BhdGNoX3VuZGVybHlpbmciLCJkaXNwYXRjaCIsImUiLCJyZXNwb25zZSQwIiwibmV3X291dCIsImNvbGxhcHNlX3NlcXVlbmNlcl9lcnJvciIsInJlc3VsdF9vcl9lcnJvciIsImV4biIsImRpc3BhdGNoJDAiLCJxdWVyeV9kaXNwYXRjaF9pZCIsInEiLCJjYW5jZWxfcmVzcG9uc2UiLCJyZWRpc3BhdGNoIiwiZm9yZ2V0X29uX3NlcnZlciIsImZvcmdldF9yZXNwb25zZSIsImxhc3RfcXVlcnkiLCJjcmVhdGUkMSIsImluaXRpYWxfcXVlcnkiLCJkaWZmcyIsImVycm9yIiwic2VxdWVuY2VyIiwiY2xlYW5pbmdfc2VxdWVuY2VyIiwic2V4cF9vZl90Iiwic2V4cF9vZl9hIiwiYSIsInNleHBfb2YiLCJjcmVhdGVfY2xpZW50IiwiaW50cm9zcGVjdCIsImNsaWVudCIsImZvbGQiLCJuZXdfZm9sZCIsInJlc3AiLCJyZXNwJDAiXSwic291cmNlcyI6WyIvVXNlcnMvdHlsYW5tb3Jhbi8ub3BhbS81LjEuMS9saWIvcG9sbGluZ19zdGF0ZV9ycGMvcG9sbGluZ19zdGF0ZV9ycGNfXy5tbCIsIi9Vc2Vycy90eWxhbm1vcmFuLy5vcGFtLzUuMS4xL2xpYi9wb2xsaW5nX3N0YXRlX3JwYy9idXNfc3RhdGUubWwiLCIvVXNlcnMvdHlsYW5tb3Jhbi8ub3BhbS81LjEuMS9saWIvcG9sbGluZ19zdGF0ZV9ycGMvcG9sbGluZ19zdGF0ZV9ycGMubWwiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7R0FLNkI7O0lBQUE7Ozs7RTs7Ozs7Ozs7Ozs7OztHOzs7OztHOzs7OztHOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztZQ1V6QkEsY0FBWSw4QkFBeUMsU0FBRSxHQUFHO1lBWTFEQyxLQUFLQztJQUNQLFlBRE9BOztLQUdNLElBQVBDLE9BQU87S0FITkQsV0FHREM7S0FFSixPQUFBLGtDQUZJQTs7O1NBR21CQztLQUFRLE9BQUEsa0NBQVJBOztRQUNWQztJQVBSSDtJQVNMLE9BQUEsc0NBRmFHO0dBRVE7WUFHckJDLFlBQVlKO0lBQ2QsSUFBSUksY0FEVUo7SUFBQUE7SUFBQUEsdUJBR2MsU0FBRTtJQUM5QixPQUFBLFdBSElJO0dBR1U7WUFHWkMsVUFBVUwsR0FBRU07SUFQWkYsWUFP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eSBkdW5lICopXG5cbigqKiBAY2Fub25pY2FsIFBvbGxpbmdfc3RhdGVfcnBjLkJ1c19zdGF0ZSAqKVxubW9kdWxlIEJ1c19zdGF0ZSA9IFBvbGxpbmdfc3RhdGVfcnBjX19CdXNfc3RhdGVcblxubW9kdWxlIFBvbGxpbmdfc3RhdGVfcnBjX18gPSBzdHJ1Y3QgZW5kXG5bQEBkZXByZWNhdGVkIFwidGhpcyBtb2R1bGUgaXMgc2hhZG93ZWRcIl1cbiIsIm9wZW4hIENvcmVcbm9wZW4gQXN5bmNfa2VybmVsXG5cbm1vZHVsZSBTdGF0ZSA9IHN0cnVjdFxuICB0eXBlICdhIHQgPVxuICAgIHwgSW5pdFxuICAgIHwgV2FpdGluZ19mb3JfbmV4dF92YWx1ZSBvZiAnYSBJdmFyLnRcbiAgICB8IFVuc2Vlbl92YWx1ZSBvZiAnYVxuZW5kXG5cbnR5cGUgJ2EgdCA9XG4gIHsgbXV0YWJsZSBzdGF0ZSA6ICdhIFN0YXRlLnRcbiAgOyBtdXRhYmxlIHVuc3Vic2NyaWJlIDogdW5pdCAtPiB1bml0XG4gIH1cblxubGV0IGNyZWF0ZSAoKSA9IHsgc3RhdGUgPSBJbml0OyB1bnN1YnNjcmliZSA9IChmdW4gKCkgLT4gKCkpIH1cblxubGV0IHB1c2ggdCB2YWx1ZSA9XG4gIHQuc3RhdGVcbiAgICA8LSAobWF0Y2ggdC5zdGF0ZSB3aXRoXG4gICAgICAgIHwgSW5pdCAtPiBVbnNlZW5fdmFsdWUgdmFsdWVcbiAgICAgICAgfCBXYWl0aW5nX2Zvcl9uZXh0X3ZhbHVlIGl2YXIgLT5cbiAgICAgICAgICBJdmFyLmZpbGxfZXhuIGl2YXIgdmFsdWU7XG4gICAgICAgICAgSW5pdFxuICAgICAgICB8IFVuc2Vlbl92YWx1ZSBfIC0+IFVuc2Vlbl92YWx1ZSB2YWx1ZSlcbjs7XG5cbmxldCB0YWtlIHQgPVxuICBtYXRjaCB0LnN0YXRlIHdpdGhcbiAgfCBJbml0IC0+XG4gICAgbGV0IGl2YXIgPSBJdmFyLmNyZWF0ZSAoKSBpblxuICAgIHQuc3RhdGUgPC0gV2FpdGluZ19mb3JfbmV4dF92YWx1ZSBpdmFyO1xuICAgIEl2YXIucmVhZCBpdmFyXG4gIHwgV2FpdGluZ19mb3JfbmV4dF92YWx1ZSBpdmFyIC0+IEl2YXIucmVhZCBpdmFyXG4gIHwgVW5zZWVuX3ZhbHVlIHZhbHVlIC0+XG4gICAgdC5zdGF0ZSA8LSBJbml0O1xuICAgIERlZmVycmVkLnJldHVybiB2YWx1ZVxuOztcblxubGV0IHVuc3Vic2NyaWJlIHQgPVxuICBsZXQgdW5zdWJzY3JpYmUgPSB0LnVuc3Vic2NyaWJlIGluXG4gIHQuc3RhdGUgPC0gSW5pdDtcbiAgdC51bnN1YnNjcmliZSA8LSAoZnVuICgpIC0+ICgpKTtcbiAgdW5zdWJzY3JpYmUgKClcbjs7XG5cbmxldCBzdWJzY3JpYmUgdCBidXMgPVxuICB1bnN1YnNjcmliZSB0O1xuICBsZXQgc3Vic2NyaWJlciA9IEJ1cy5zdWJzY3JpYmVfZXhuIGJ1cyBbJWhlcmVdIH5mOihmdW4gcmVzcG9uc2UgLT4gcHVzaCB0IHJlc3BvbnNlKSBpblxuICB0LnVuc3Vic2NyaWJlIDwtIChmdW4gKCkgLT4gQnVzLnVuc3Vic2NyaWJlIGJ1cyBzdWJzY3JpYmVyKVxuOztcbiIsIm9wZW4hIENvcmVcbm9wZW4hIEFzeW5jX2tlcm5lbFxub3BlbiEgQXN5bmNfcnBjX2tlcm5lbFxuXG5tb2R1bGUgU2VxbnVtID0gc3RydWN0XG4gIGluY2x1ZGUgVW5pcXVlX2lkLkludCAoKVxuXG4gIGxldCBmb3JnZXQgPSBvZl9pbnRfZXhuICgtMSlcbmVuZFxuXG5tb2R1bGUgUXVlcnlfZGlzcGF0Y2hfaWQgPSBVbmlxdWVfaWQuSW50ICgpXG5cbigqIEEgQ2xpZW50X2lkLnQgaXMgdW5pcXVlIHBlciBDbGllbnQudCBmb3IgYSBnaXZlbiBjb25uZWN0aW9uLlxuICAgVGhleSBhcmUgbm90IGd1YXJhbnRlZWQgdG8gYmUgdW5pcXVlIGJldHdlZW4gY29ubmVjdGlvbnMuIFdlIG5lZWQgdGhpc1xuICAgYmVjYXVzZSBhIHVzZXIgY291bGQgaGF2ZSBtdWx0aXBsZSBDbGllbnQudCBmb3IgdGhlIHNhbWUgUnBjLiAqKVxubW9kdWxlIENsaWVudF9pZCA9IFVuaXF1ZV9pZC5JbnQgKClcblxubW9kdWxlIENhY2hlIDogc2lnXG4gIHR5cGUgKCdhLCAnY2xpZW50X3N0YXRlKSB0XG4gIHR5cGUgKCdhLCAnY2xpZW50X3N0YXRlKSBwZXJfY2xpZW50XG5cbiAgdmFsIGNyZWF0ZSA6IG9uX2NsaWVudF9mb3Jnb3R0ZW46KCdjbGllbnRfc3RhdGUgLT4gdW5pdCkgLT4gKCdhLCAnY2xpZW50X3N0YXRlKSB0XG5cbiAgdmFsIGZpbmRcbiAgICA6ICAoJ2EsICdjbGllbnRfc3RhdGUpIHRcbiAgICAtPiBjb25uZWN0aW9uX3N0YXRlOidjb25uZWN0aW9uX3N0YXRlXG4gICAgLT4gY29ubmVjdGlvbjpScGMuQ29ubmVjdGlvbi50XG4gICAgLT4gY2xpZW50X2lkOkNsaWVudF9pZC50XG4gICAgLT4gY3JlYXRlX2NsaWVudF9zdGF0ZTooJ2Nvbm5lY3Rpb25fc3RhdGUgLT4gJ2NsaWVudF9zdGF0ZSlcbiAgICAtPiAoJ2EsICdjbGllbnRfc3RhdGUpIHBlcl9jbGllbnRcblxuICB2YWwgcmVtb3ZlX2FuZF90cmlnZ2VyX2NhbmNlbFxuICAgIDogICgnYSwgJ2NsaWVudF9zdGF0ZSkgdFxuICAgIC0+IGNvbm5lY3Rpb246UnBjLkNvbm5lY3Rpb24udFxuICAgIC0+IGNsaWVudF9pZDpDbGllbnRfaWQudFxuICAgIC0+IHVuaXRcblxuICB2YWwgbGFzdF9yZXNwb25zZSA6ICgnYSwgJ2NsaWVudF9zdGF0ZSkgcGVyX2NsaWVudCAtPiAoJ2EgKiBTZXFudW0udCkgb3B0aW9uXG4gIHZhbCBzZXQgOiAoJ2EsICdjbGllbnRfc3RhdGUpIHBlcl9jbGllbnQgLT4gJ2EgLT4gU2VxbnVtLnRcbiAgdmFsIHdhaXRfZm9yX2NhbmNlbCA6ICgnYSwgJ2NsaWVudF9zdGF0ZSkgcGVyX2NsaWVudCAtPiB1bml0IERlZmVycmVkLnRcbiAgdmFsIHRyaWdnZXJfY2FuY2VsIDogKCdhLCAnY2xpZW50X3N0YXRlKSBwZXJfY2xpZW50IC0+IHVuaXRcbiAgdmFsIGNsaWVudF9zdGF0ZSA6ICgnYSwgJ2NsaWVudF9zdGF0ZSkgcGVyX2NsaWVudCAtPiAnY2xpZW50X3N0YXRlXG5lbmQgPSBzdHJ1Y3RcbiAgdHlwZSAoJ2EsICdjbGllbnRfc3RhdGUpIHBlcl9jbGllbnQgPVxuICAgIHsgbXV0YWJsZSBsYXN0X3Jlc3BvbnNlIDogKCdhICogU2VxbnVtLnQpIG9wdGlvblxuICAgIDsgbXV0YWJsZSBjYW5jZWwgOiB1bml0IEl2YXIudFxuICAgIDsgY2xpZW50X3N0YXRlIDogJ2NsaWVudF9zdGF0ZVxuICAgIH1cblxuICB0eXBlICgnYSwgJ2NsaWVudF9zdGF0ZSkgcGVyX2Nvbm5lY3Rpb24gPVxuICAgICgnYSwgJ2NsaWVudF9zdGF0ZSkgcGVyX2NsaWVudCBDbGllbnRfaWQuVGFibGUudFxuXG4gIHR5cGUgKCdhLCAnY2xpZW50X3N0YXRlKSB0ID1cbiAgICB7IGNvbm5lY3Rpb25zIDogKFJwYy5Db25uZWN0aW9uLnQgKiAoJ2EsICdjbGllbnRfc3RhdGUpIHBlcl9jb25uZWN0aW9uKSBCYWcudFxuICAgIDsgb25fY2xpZW50X2ZvcmdvdHRlbiA6ICdjbGllbnRfc3RhdGUgLT4gdW5pdFxuICAgIH1cblxuICBsZXQgY3JlYXRlIH5vbl9jbGllbnRfZm9yZ290dGVuID0geyBjb25uZWN0aW9ucyA9IEJhZy5jcmVhdGUgKCk7IG9uX2NsaWVudF9mb3Jnb3R0ZW4gfVxuXG4gIGxldCBmaW5kX2J5X2Nvbm5lY3Rpb24gdCB+Y29ubmVjdGlvbiA9XG4gICAgQmFnLmZpbmQgdCB+ZjooZnVuIChjb25uLCBfKSAtPiBwaHlzX2VxdWFsIGNvbm5lY3Rpb24gY29ubikgfD4gT3B0aW9uLm1hcCB+ZjpzbmRcbiAgOztcblxuICBsZXQgZmluZCB0IH5jb25uZWN0aW9uX3N0YXRlIH5jb25uZWN0aW9uIH5jbGllbnRfaWQgfmNyZWF0ZV9jbGllbnRfc3RhdGUgPVxuICAgIGxldCBwZXJfY29ubmVjdGlvbiA9XG4gICAgICBtYXRjaCBmaW5kX2J5X2Nvbm5lY3Rpb24gdC5jb25uZWN0aW9ucyB+Y29ubmVjdGlvbiB3aXRoXG4gICAgICB8IFNvbWUgcGVyX2Nvbm5lY3Rpb24gLT4gcGVyX2Nvbm5lY3Rpb25cbiAgICAgIHwgTm9uZSAtPlxuICAgICAgICBsZXQgcmVzdWx0ID0gQ2xpZW50X2lkLlRhYmxlLmNyZWF0ZSAoKSBpblxuICAgICAgICBsZXQgZWx0ID0gQmFnLmFkZCB0LmNvbm5lY3Rpb25zIChjb25uZWN0aW9uLCByZXN1bHQpIGluXG4gICAgICAgIERlZmVycmVkLnVwb24gKFJwYy5Db25uZWN0aW9uLmNsb3NlX2ZpbmlzaGVkIGNvbm5lY3Rpb24pIChmdW4gKCkgLT5cbiAgICAgICAgICBIYXNodGJsLml0ZXIgcmVzdWx0IH5mOihmdW4geyBjbGllbnRfc3RhdGU7IF8gfSAtPlxuICAgICAgICAgICAgdC5vbl9jbGllbnRfZm9yZ290dGVuIGNsaWVudF9zdGF0ZSk7XG4gICAgICAgICAgQmFnLnJlbW92ZSB0LmNvbm5lY3Rpb25zIGVsdCk7XG4gICAgICAgIHJlc3VsdFxuICAgIGluXG4gICAgSGFzaHRibC5maW5kX29yX2FkZCBwZXJfY29ubmVjdGlvbiBjbGllbnRfaWQgfmRlZmF1bHQ6KGZ1biAoKSAtPlxuICAgICAgeyBsYXN0X3Jlc3BvbnNlID0gTm9uZVxuICAgICAgOyBjYW5jZWwgPSBJdmFyLmNyZWF0ZSAoKVxuICAgICAgOyBjbGllbnRfc3RhdGUgPSBjcmVhdGVfY2xpZW50X3N0YXRlIGNvbm5lY3Rpb25fc3RhdGVcbiAgICAgIH0pXG4gIDs7XG5cbiAgbGV0IHJlbW92ZV9hbmRfdHJpZ2dlcl9jYW5jZWwgdCB+Y29ubmVjdGlvbiB+Y2xpZW50X2lkID1cbiAgICBPcHRpb24uaXRlciAoZmluZF9ieV9jb25uZWN0aW9uIHQuY29ubmVjdGlvbnMgfmNvbm5lY3Rpb24pIH5mOihmdW4gcGVyX2Nvbm5lY3Rpb24gLT5cbiAgICAgIE9wdGlvbi5pdGVyIChIYXNodGJsLmZpbmRfYW5kX3JlbW92ZSBwZXJfY29ubmVjdGlvbiBjbGllbnRfaWQpIH5mOihmdW4gcGVyX2NsaWVudCAtPlxuICAgICAgICB0Lm9uX2NsaWVudF9mb3Jnb3R0ZW4gcGVyX2NsaWVudC5jbGllbnRfc3RhdGU7XG4gICAgICAgIEl2YXIuZmlsbF9leG4gcGVyX2NsaWVudC5jYW5jZWwgKCkpKVxuICA7O1xuXG4gIGxldCBsYXN0X3Jlc3BvbnNlIHBlcl9jbGllbnQgPSBwZXJfY2xpZW50Lmxhc3RfcmVzcG9uc2VcblxuICBsZXQgc2V0IHBlcl9jbGllbnQgZGF0YSA9XG4gICAgbGV0IHNlcW51bSA9IFNlcW51bS5jcmVhdGUgKCkgaW5cbiAgICBwZXJfY2xpZW50Lmxhc3RfcmVzcG9uc2UgPC0gU29tZSAoZGF0YSwgc2VxbnVtKTtcbiAgICBzZXFudW1cbiAgOztcblxuICBsZXQgd2FpdF9mb3JfY2FuY2VsIHBlcl9jbGllbnQgPSBJdmFyLnJlYWQgcGVyX2NsaWVudC5jYW5jZWxcblxuICBsZXQgdHJpZ2dlcl9jYW5jZWwgcGVyX2NsaWVudCA9XG4gICAgSXZhci5maWxsX2V4biBwZXJfY2xpZW50LmNhbmNlbCAoKTtcbiAgICBwZXJfY2xpZW50LmNhbmNlbCA8LSBJdmFyLmNyZWF0ZSAoKVxuICA7O1xuXG4gIGxldCBjbGllbnRfc3RhdGUgcGVyX2NsaWVudCA9IHBlcl9jbGllbnQuY2xpZW50X3N0YXRlXG5lbmRcblxubW9kdWxlIFJlcXVlc3QgPSBzdHJ1Y3RcbiAgKCogV2UgbWFpbnRhaW4gdHdvIHZhcmlhdGlvbnMgb2YgdGhlIHJlcXVlc3QgdHlwZSBzbyB0aGF0IHdlIGNhbiBjaGFuZ2Ugb25lXG4gICAgIG9mIHRoZW0gd2hpbGUga2VlcGluZyB0aGUgb3RoZXIgZml4ZWQuIFRoZSBzdGFibGUgdHlwZSBzaG91bGQgYmUgdXNlZCBvbmx5XG4gICAgIGFzIGFuIGludGVybWVkaWF0ZSBzdGVwIG9mIChkZSlzZXJpYWxpemF0aW9uLlxuXG4gICAgIENoYW5naW5nIHRoZSB1bnN0YWJsZSB0eXBlIHJlcXVpcmVzIGZpZ3VyaW5nIG91dCBob3cgdG8gZW5jb2RlL2RlY29kZSBhbnlcbiAgICAgYWRkaXRpb25hbCBkYXRhIGludG8vb3V0LW9mIHRoZSBvbGQgc3RhYmxlIHR5cGUgdXNpbmcgdGhlIFt1bnN0YWJsZV9vZl9zdGFibGVdXG4gICAgIGFuZCBbc3RhYmxlX29mX3Vuc3RhYmxlXS4gKilcblxuICBtb2R1bGUgVW5zdGFibGUgPSBzdHJ1Y3RcbiAgICB0eXBlICdxdWVyeSB0ID1cbiAgICAgIHwgUXVlcnkgb2ZcbiAgICAgICAgICB7IGxhc3Rfc2VxbnVtIDogU2VxbnVtLnQgb3B0aW9uXG4gICAgICAgICAgOyBxdWVyeSA6ICdxdWVyeVxuICAgICAgICAgIDsgY2xpZW50X2lkIDogQ2xpZW50X2lkLnRcbiAgICAgICAgICB9XG4gICAgICB8IENhbmNlbF9vbmdvaW5nIG9mIENsaWVudF9pZC50XG4gICAgICB8IEZvcmdldF9jbGllbnQgb2ZcbiAgICAgICAgICB7IHF1ZXJ5IDogJ3F1ZXJ5XG4gICAgICAgICAgOyBjbGllbnRfaWQgOiBDbGllbnRfaWQudFxuICAgICAgICAgIH1cbiAgZW5kXG5cbiAgbW9kdWxlIFN0YWJsZSA9IHN0cnVjdFxuICAgIHR5cGUgJ3F1ZXJ5IHQgPVxuICAgICAgfCBRdWVyeSBvZlxuICAgICAgICAgIHsgbGFzdF9zZXFudW0gOiBTZXFudW0udCBvcHRpb25cbiAgICAgICAgICA7IHF1ZXJ5IDogJ3F1ZXJ5XG4gICAgICAgICAgOyBjbGllbnRfaWQgOiBDbGllbnRfaWQudFxuICAgICAgICAgIH1cbiAgICAgIHwgQ2FuY2VsX29uZ29pbmcgb2YgQ2xpZW50X2lkLnRcbiAgICBbQEBkZXJpdmluZyBiaW5faW9dXG5cbiAgICBsZXQlZXhwZWN0X3Rlc3QgXyA9XG4gICAgICBwcmludF9lbmRsaW5lIFslYmluX2RpZ2VzdDogdW5pdCB0XTtcbiAgICAgIFslZXhwZWN0IHt8IDRlYjU1NGZhZGQ3ZWRlZDM3ZTRkYTg5ZWZkMjA4YzUyIHx9XVxuICAgIDs7XG4gIGVuZFxuXG4gIGxldCB1bnN0YWJsZV9vZl9zdGFibGUgOiAncXVlcnkgU3RhYmxlLnQgLT4gJ3F1ZXJ5IFVuc3RhYmxlLnQgPSBmdW5jdGlvblxuICAgIHwgUXVlcnkgeyBsYXN0X3NlcW51bSA9IFNvbWUgbGFzdF9zZXFudW07IHF1ZXJ5OyBjbGllbnRfaWQgfVxuICAgICAgd2hlbiBbJWVxdWFsOiBTZXFudW0udF0gbGFzdF9zZXFudW0gU2VxbnVtLmZvcmdldCAtPlxuICAgICAgRm9yZ2V0X2NsaWVudCB7IHF1ZXJ5OyBjbGllbnRfaWQgfVxuICAgIHwgUXVlcnkgeyBsYXN0X3NlcW51bTsgcXVlcnk7IGNsaWVudF9pZCB9IC0+IFF1ZXJ5IHsgbGFzdF9zZXFudW07IHF1ZXJ5OyBjbGllbnRfaWQgfVxuICAgIHwgQ2FuY2VsX29uZ29pbmcgY2xpZW50X2lkIC0+IENhbmNlbF9vbmdvaW5nIGNsaWVudF9pZFxuICA7O1xuXG4gIGxldCBzdGFibGVfb2ZfdW5zdGFibGUgOiAncXVlcnkgVW5zdGFibGUudCAtPiAncXVlcnkgU3RhYmxlLnQgPSBmdW5jdGlvblxuICAgIHwgUXVlcnkgeyBsYXN0X3NlcW51bTsgcXVlcnk7IGNsaWVudF9pZCB9IC0+IFF1ZXJ5IHsgbGFzdF9zZXFudW07IHF1ZXJ5OyBjbGllbnRfaWQgfVxuICAgIHwgQ2FuY2VsX29uZ29pbmcgY2xpZW50X2lkIC0+IENhbmNlbF9vbmdvaW5nIGNsaWVudF9pZFxuICAgIHwgRm9yZ2V0X2NsaWVudCB7IHF1ZXJ5OyBjbGllbnRfaWQgfSAtPlxuICAgICAgUXVlcnkgeyBsYXN0X3NlcW51bSA9IFNvbWUgU2VxbnVtLmZvcmdldDsgcXVlcnk7IGNsaWVudF9pZCB9XG4gIDs7XG5lbmRcblxubW9kdWxlIFJlc3BvbnNlID0gc3RydWN0XG4gIHR5cGUgKCdyZXNwb25zZSwgJ3VwZGF0ZSkgdCA9XG4gICAgfCBGcmVzaCBvZiAncmVzcG9uc2VcbiAgICB8IFVwZGF0ZSBvZiAndXBkYXRlXG4gIFtAQGRlcml2aW5nIGJpbl9pbywgc2V4cF9vZl1cblxuICBsZXQlZXhwZWN0X3Rlc3QgXyA9XG4gICAgcHJpbnRfZW5kbGluZSBbJWJpbl9kaWdlc3Q6IChpbnQsIHN0cmluZykgdF07XG4gICAgWyVleHBlY3Qge3wgMTNlZjhjNTIyM2EwZWEyODRjNzI1MTJiZTMyZTVjMDkgfH1dXG4gIDs7XG5cbiAgdHlwZSAoJ3Jlc3BvbnNlLCAndXBkYXRlKSBwYWlyID1cbiAgICB8IFJlc3BvbnNlIG9mXG4gICAgICAgIHsgbmV3X3NlcW51bSA6IFNlcW51bS50XG4gICAgICAgIDsgcmVzcG9uc2UgOiAoJ3Jlc3BvbnNlLCAndXBkYXRlKSB0XG4gICAgICAgIH1cbiAgICB8IENhbmNlbGxhdGlvbl9zdWNjZXNzZnVsXG4gIFtAQGRlcml2aW5nIGJpbl9pb11cblxuICBsZXQlZXhwZWN0X3Rlc3QgXyA9XG4gICAgcHJpbnRfZW5kbGluZSBbJWJpbl9kaWdlc3Q6IChpbnQsIHN0cmluZykgcGFpcl07XG4gICAgWyVleHBlY3Qge3wgOGJjNjNhODU1NjFkODdiNjkzZDE1ZTc4YzY0ZTEwMDggfH1dXG4gIDs7XG5lbmRcblxubW9kdWxlIHR5cGUgUmVzcG9uc2UgPSBzaWdcbiAgKCoqIFRoaXMgaXMgYSBzdWJzZXQgb2YgdGhlIGRpZmZhYmxlIHNpZ25hdHVyZSAod2l0aG91dCBbdG9fZGlmZnNdIGFuZCBbb2ZfZGlmZnNdKVxuICAgICAgYW5kIHdpdGggdGhlIGRpZmZhYmxlIHR5cGUgYWxzbyBzdXBwb3J0aW5nIGJpbl9pbyAqKVxuXG4gIHR5cGUgdCBbQEBkZXJpdmluZyBiaW5faW9dXG5cbiAgbW9kdWxlIFVwZGF0ZSA6IHNpZ1xuICAgIHR5cGUgdCBbQEBkZXJpdmluZyBiaW5faW8sIHNleHBfb2ZdXG4gIGVuZFxuXG4gIHZhbCBkaWZmcyA6IGZyb206dCAtPiB0b186dCAtPiBVcGRhdGUudFxuICB2YWwgdXBkYXRlIDogdCAtPiBVcGRhdGUudCAtPiB0XG5lbmRcblxudHlwZSAoJ3F1ZXJ5LCAncmVzcG9uc2UpIHQgPVxuICB8IFQgOlxuICAgICAgeyByZXNwb25zZV9tb2R1bGUgOlxuICAgICAgICAgIChtb2R1bGUgUmVzcG9uc2Ugd2l0aCB0eXBlIHQgPSAncmVzcG9uc2UgYW5kIHR5cGUgVXBkYXRlLnQgPSAnZGlmZilcbiAgICAgIDsgcXVlcnlfZXF1YWwgOiAncXVlcnkgLT4gJ3F1ZXJ5IC0+IGJvb2xcbiAgICAgIDsgdW5kZXJseWluZ19ycGMgOlxuICAgICAgICAgICgncXVlcnkgUmVxdWVzdC5TdGFibGUudCwgKCdyZXNwb25zZSwgJ2RpZmYpIFJlc3BvbnNlLnBhaXIpIFJwYy5ScGMudFxuICAgICAgfVxuICAgICAgLT4gKCdxdWVyeSwgJ3Jlc3BvbnNlKSB0XG5cbmxldCBuYW1lIChUIHsgdW5kZXJseWluZ19ycGM7IF8gfSkgPSBScGMuUnBjLm5hbWUgdW5kZXJseWluZ19ycGNcbmxldCB2ZXJzaW9uIChUIHsgdW5kZXJseWluZ19ycGM7IF8gfSkgPSBScGMuUnBjLnZlcnNpb24gdW5kZXJseWluZ19ycGNcbmxldCBiYWJlbF9nZW5lcmljX3JwYyAoVCB7IHVuZGVybHlpbmdfcnBjOyBfIH0pID0gQmFiZWwuR2VuZXJpY19ycGMuUnBjIHVuZGVybHlpbmdfcnBjXG5cbmxldCBjcmVhdGVcbiAgKHR5cGUgYSlcbiAgfm5hbWVcbiAgfnZlcnNpb25cbiAgfnF1ZXJ5X2VxdWFsXG4gIH5iaW5fcXVlcnlcbiAgKG1vZHVsZSBNIDogUmVzcG9uc2Ugd2l0aCB0eXBlIHQgPSBhKVxuICA9XG4gIGxldCBiaW5fcmVzcG9uc2UgPSBSZXNwb25zZS5iaW5fcGFpciBNLmJpbl90IE0uVXBkYXRlLmJpbl90IGluXG4gIGxldCBiaW5fcXVlcnkgPSBSZXF1ZXN0LlN0YWJsZS5iaW5fdCBiaW5fcXVlcnkgaW5cbiAgVFxuICAgIHsgcXVlcnlfZXF1YWxcbiAgICA7IHJlc3BvbnNlX21vZHVsZSA9IChtb2R1bGUgTSlcbiAgICA7IHVuZGVybHlpbmdfcnBjID1cbiAgICAgICAgUnBjLlJwYy5jcmVhdGVcbiAgICAgICAgICB+bmFtZVxuICAgICAgICAgIH52ZXJzaW9uXG4gICAgICAgICAgfmJpbl9xdWVyeVxuICAgICAgICAgIH5iaW5fcmVzcG9uc2VcbiAgICAgICAgICB+aW5jbHVkZV9pbl9lcnJvcl9jb3VudDpPbmx5X29uX2V4blxuICAgIH1cbjs7XG5cbmxldCBpbXBsZW1lbnRfd2l0aF9jbGllbnRfc3RhdGVcbiAgKHR5cGUgcmVzcG9uc2UpXG4gIH5vbl9jbGllbnRfYW5kX3NlcnZlcl9vdXRfb2Zfc3luY1xuICB+Y3JlYXRlX2NsaWVudF9zdGF0ZVxuICA/KG9uX2NsaWVudF9mb3Jnb3R0ZW4gPSBpZ25vcmUpXG4gID9mb3JfZmlyc3RfcmVxdWVzdFxuICB0XG4gIGZcbiAgPVxuICAoKiBtYWtlIGEgbmV3IGZ1bmN0aW9uIHRvIGludHJvZHVjZSBhIGxvY2FsbHkgYWJzdHJhY3QgdHlwZSBmb3IgZGlmZiAqKVxuICBsZXQgZG9faW1wbGVtZW50XG4gICAgOiB0eXBlIGRpZmYuXG4gICAgICByZXNwb25zZV9tb2R1bGU6KG1vZHVsZSBSZXNwb25zZSB3aXRoIHR5cGUgdCA9IHJlc3BvbnNlIGFuZCB0eXBlIFVwZGF0ZS50ID0gZGlmZilcbiAgICAgIC0+IHVuZGVybHlpbmdfcnBjOihfLCAocmVzcG9uc2UsIGRpZmYpIFJlc3BvbnNlLnBhaXIpIFJwYy5ScGMudFxuICAgICAgLT4gX1xuICAgID1cbiAgICBmdW4gfnJlc3BvbnNlX21vZHVsZSB+dW5kZXJseWluZ19ycGMgfnF1ZXJ5X2VxdWFsIC0+XG4gICAgbGV0IG1vZHVsZSBNID0gKHZhbCByZXNwb25zZV9tb2R1bGUpIGluXG4gICAgbGV0IGZvcl9maXJzdF9yZXF1ZXN0ID0gT3B0aW9uLnZhbHVlIGZvcl9maXJzdF9yZXF1ZXN0IH5kZWZhdWx0OmYgaW5cbiAgICBsZXQgaW5pdCBjb25uZWN0aW9uX3N0YXRlIGNsaWVudF9zdGF0ZSBxdWVyeSA9XG4gICAgICBsZXQlbWFwIHJlc3BvbnNlID0gZm9yX2ZpcnN0X3JlcXVlc3QgY29ubmVjdGlvbl9zdGF0ZSBjbGllbnRfc3RhdGUgcXVlcnkgaW5cbiAgICAgIHJlc3BvbnNlLCByZXNwb25zZVxuICAgIGluXG4gICAgbGV0IHVwZGF0ZXMgY29ubmVjdGlvbl9zdGF0ZSBjbGllbnRfc3RhdGUgfnByZXY6KHByZXZfcXVlcnksIHByZXZfcmVzcG9uc2UpIHF1ZXJ5ID1cbiAgICAgIGxldCBmID0gaWYgcXVlcnlfZXF1YWwgcHJldl9xdWVyeSBxdWVyeSB0aGVuIGYgZWxzZSBmb3JfZmlyc3RfcmVxdWVzdCBpblxuICAgICAgbGV0JW1hcCBuZXdfID0gZiBjb25uZWN0aW9uX3N0YXRlIGNsaWVudF9zdGF0ZSBxdWVyeSBpblxuICAgICAgbGV0IGRpZmYgPSBNLmRpZmZzIH5mcm9tOnByZXZfcmVzcG9uc2UgfnRvXzpuZXdfIGluXG4gICAgICBSZXNwb25zZS5VcGRhdGUgZGlmZiwgbmV3X1xuICAgIGluXG4gICAgbGV0IGNhY2hlID0gQ2FjaGUuY3JlYXRlIH5vbl9jbGllbnRfZm9yZ290dGVuIGluXG4gICAgUnBjLlJwYy5pbXBsZW1lbnQgdW5kZXJseWluZ19ycGMgKGZ1biAoY29ubmVjdGlvbl9zdGF0ZSwgY29ubmVjdGlvbikgcmVxdWVzdCAtPlxuICAgICAgbWF0Y2ggUmVxdWVzdC51bnN0YWJsZV9vZl9zdGFibGUgcmVxdWVzdCB3aXRoXG4gICAgICB8IENhbmNlbF9vbmdvaW5nIGNsaWVudF9pZCAtPlxuICAgICAgICBsZXQgcGVyX2NsaWVudCA9XG4gICAgICAgICAgQ2FjaGUuZmluZCBjYWNoZSB+Y29ubmVjdGlvbl9zdGF0ZSB+Y29ubmVjdGlvbiB+Y2xpZW50X2lkIH5jcmVhdGVfY2xpZW50X3N0YXRlXG4gICAgICAgIGluXG4gICAgICAgIENhY2hlLnRyaWdnZXJfY2FuY2VsIHBlcl9jbGllbnQ7XG4gICAgICAgIHJldHVybiBSZXNwb25zZS5DYW5jZWxsYXRpb25fc3VjY2Vzc2Z1bFxuICAgICAgfCBGb3JnZXRfY2xpZW50IHsgcXVlcnkgPSBfOyBjbGllbnRfaWQgfSAtPlxuICAgICAgICBDYWNoZS5yZW1vdmVfYW5kX3RyaWdnZXJfY2FuY2VsIGNhY2hlIH5jb25uZWN0aW9uIH5jbGllbnRfaWQ7XG4gICAgICAgIHJldHVybiBSZXNwb25zZS5DYW5jZWxsYXRpb25fc3VjY2Vzc2Z1bFxuICAgICAgfCBRdWVyeSB7IGxhc3Rfc2VxbnVtOyBxdWVyeTsgY2xpZW50X2lkIH0gLT5cbiAgICAgICAgbGV0IHBlcl9jbGllbnQgPVxuICAgICAgICAgIENhY2hlLmZpbmQgY2FjaGUgfmNvbm5lY3Rpb25fc3RhdGUgfmNvbm5lY3Rpb24gfmNsaWVudF9pZCB+Y3JlYXRlX2NsaWVudF9zdGF0ZVxuICAgICAgICBpblxuICAgICAgICBsZXQgcHJldiA9XG4gICAgICAgICAgbWF0Y2ggQ2FjaGUubGFzdF9yZXNwb25zZSBwZXJfY2xpZW50LCBsYXN0X3NlcW51bSB3aXRoXG4gICAgICAgICAgfCBTb21lIChwcmV2LCBwcmV2X3NlcW51bSksIFNvbWUgbGFzdF9zZXFudW0gLT5cbiAgICAgICAgICAgIChtYXRjaCBTZXFudW0uZXF1YWwgcHJldl9zZXFudW0gbGFzdF9zZXFudW0gd2l0aFxuICAgICAgICAgICAgIHwgdHJ1ZSAtPiBTb21lIHByZXZcbiAgICAgICAgICAgICB8IGZhbHNlIC0+XG4gICAgICAgICAgICAgICBsZXQgcnBjX25hbWUgPSBScGMuUnBjLm5hbWUgdW5kZXJseWluZ19ycGMgaW5cbiAgICAgICAgICAgICAgIGxldCBycGNfdmVyc2lvbiA9IFJwYy5ScGMudmVyc2lvbiB1bmRlcmx5aW5nX3JwYyBpblxuICAgICAgICAgICAgICAgb25fY2xpZW50X2FuZF9zZXJ2ZXJfb3V0X29mX3N5bmNcbiAgICAgICAgICAgICAgICAgWyVtZXNzYWdlXG4gICAgICAgICAgICAgICAgICAgWyVoZXJlXVxuICAgICAgICAgICAgICAgICAgICAgXCJBIHBvbGxpbmcgc3RhdGUgUlBDIGNsaWVudCBoYXMgcmVxdWVzdGVkIGRpZmZzIGZyb20gYSBzZXFudW0gdGhhdCBcXFxuICAgICAgICAgICAgICAgICAgICAgIHRoZSBzZXJ2ZXIgZG9lcyBub3QgaGF2ZSwgc28gdGhlIHNlcnZlciBpcyBzZW5kaW5nIGEgZnJlc2ggXFxcbiAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZSBpbnN0ZWFkLiBUaGlzIGxpa2VseSBtZWFucyB0aGF0IHRoZSBjbGllbnQgaGFkIHRyb3VibGUgXFxcbiAgICAgICAgICAgICAgICAgICAgICByZWNlaXZpbmcgdGhlIGxhc3QgUlBDIHJlc3BvbnNlLlwiXG4gICAgICAgICAgICAgICAgICAgICAocnBjX25hbWUgOiBzdHJpbmcpXG4gICAgICAgICAgICAgICAgICAgICAocnBjX3ZlcnNpb24gOiBpbnQpXTtcbiAgICAgICAgICAgICAgIE5vbmUpXG4gICAgICAgICAgfCBOb25lLCBTb21lIF8gfCBOb25lLCBOb25lIC0+IE5vbmVcbiAgICAgICAgICB8IFNvbWUgXywgTm9uZSAtPlxuICAgICAgICAgICAgbGV0IHJwY19uYW1lID0gUnBjLlJwYy5uYW1lIHVuZGVybHlpbmdfcnBjIGluXG4gICAgICAgICAgICBsZXQgcnBjX3ZlcnNpb24gPSBScGMuUnBjLnZlcnNpb24gdW5kZXJseWluZ19ycGMgaW5cbiAgICAgICAgICAgIG9uX2NsaWVudF9hbmRfc2VydmVyX291dF9vZl9zeW5jXG4gICAgICAgICAgICAgIFslbWVzc2FnZVxuICAgICAgICAgICAgICAgIFslaGVyZV1cbiAgICAgICAgICAgICAgICAgIFwiQSBwb2xsaW5nIHN0YXRlIFJQQyBjbGllbnQgaGFzIHJlcXVlc3RlZCBhIGZyZXNoIHJlc3BvbnNlLCBidXQgdGhlIFxcXG4gICAgICAgICAgICAgICAgICAgc2VydmVyIGV4cGVjdGVkIGl0IHRvIGhhdmUgdGhlIHNlcW51bSBvZiB0aGUgbGF0ZXN0IGRpZmZzLiBUaGUgc2VydmVyIFxcXG4gICAgICAgICAgICAgICAgICAgd2lsbCBzZW5kIGEgZnJlc2ggcmVzcG9uc2UgYXMgcmVxdWVzdGVkLiBUaGlzIGxpa2VseSBtZWFucyB0aGF0IHRoZSBcXFxuICAgICAgICAgICAgICAgICAgIGNsaWVudCBoYWQgdHJvdWJsZSByZWNlaXZpbmcgdGhlIGxhc3QgUlBDIHJlc3BvbnNlLlwiXG4gICAgICAgICAgICAgICAgICAocnBjX25hbWUgOiBzdHJpbmcpXG4gICAgICAgICAgICAgICAgICAocnBjX3ZlcnNpb24gOiBpbnQpXTtcbiAgICAgICAgICAgIE5vbmVcbiAgICAgICAgaW5cbiAgICAgICAgbGV0IHJlc3BvbnNlID1cbiAgICAgICAgICBsZXQgY2xpZW50X3N0YXRlID0gQ2FjaGUuY2xpZW50X3N0YXRlIHBlcl9jbGllbnQgaW5cbiAgICAgICAgICBtYXRjaCBwcmV2IHdpdGhcbiAgICAgICAgICB8IFNvbWUgcHJldiAtPlxuICAgICAgICAgICAgbGV0JW1hcCByZXNwb25zZSwgdXNlcmRhdGEgPVxuICAgICAgICAgICAgICB1cGRhdGVzIGNvbm5lY3Rpb25fc3RhdGUgY2xpZW50X3N0YXRlIH5wcmV2IHF1ZXJ5XG4gICAgICAgICAgICBpblxuICAgICAgICAgICAgcmVzcG9uc2UsIHVzZXJkYXRhXG4gICAgICAgICAgfCBOb25lIC0+XG4gICAgICAgICAgICBsZXQlbWFwIHJlc3BvbnNlLCB1c2VyZGF0YSA9IGluaXQgY29ubmVjdGlvbl9zdGF0ZSBjbGllbnRfc3RhdGUgcXVlcnkgaW5cbiAgICAgICAgICAgIFJlc3BvbnNlLkZyZXNoIHJlc3BvbnNlLCB1c2VyZGF0YVxuICAgICAgICBpblxuICAgICAgICBsZXQgcmVzcG9uc2Vfb3JfY2FuY2VsbGVkID1cbiAgICAgICAgICBjaG9vc2VcbiAgICAgICAgICAgIFsgY2hvaWNlIHJlc3BvbnNlIChmdW4gciAtPiBgUmVzcG9uc2UgcilcbiAgICAgICAgICAgIDsgY2hvaWNlIChDYWNoZS53YWl0X2Zvcl9jYW5jZWwgcGVyX2NsaWVudCkgKGZ1biAoKSAtPiBgQ2FuY2VsbGVkKVxuICAgICAgICAgICAgXVxuICAgICAgICBpblxuICAgICAgICAobWF0Y2glbWFwIHJlc3BvbnNlX29yX2NhbmNlbGxlZCB3aXRoXG4gICAgICAgICB8IGBSZXNwb25zZSAocmVzcG9uc2UsIHVzZXJkYXRhKSAtPlxuICAgICAgICAgICBsZXQgbmV3X3NlcW51bSA9IENhY2hlLnNldCBwZXJfY2xpZW50IChxdWVyeSwgdXNlcmRhdGEpIGluXG4gICAgICAgICAgIENhY2hlLnRyaWdnZXJfY2FuY2VsIHBlcl9jbGllbnQ7XG4gICAgICAgICAgIFJlc3BvbnNlLlJlc3BvbnNlIHsgbmV3X3NlcW51bTsgcmVzcG9uc2UgfVxuICAgICAgICAgfCBgQ2FuY2VsbGVkIC0+XG4gICAgICAgICAgIEV4bi5yYWlzZV93aXRob3V0X2JhY2t0cmFjZSAoRmFpbHVyZSBcInRoaXMgcmVxdWVzdCB3YXMgY2FuY2VsbGVkXCIpKSlcbiAgaW5cbiAgbGV0IChUIHsgcXVlcnlfZXF1YWw7IHJlc3BvbnNlX21vZHVsZTsgdW5kZXJseWluZ19ycGMgfSkgPSB0IGluXG4gIGRvX2ltcGxlbWVudCB+cmVzcG9uc2VfbW9kdWxlIH51bmRlcmx5aW5nX3JwYyB+cXVlcnlfZXF1YWxcbjs7XG5cbmxldCBpbXBsZW1lbnQgfm9uX2NsaWVudF9hbmRfc2VydmVyX291dF9vZl9zeW5jID9mb3JfZmlyc3RfcmVxdWVzdCB0IGYgPVxuICBsZXQgZm9yX2ZpcnN0X3JlcXVlc3QgPVxuICAgIE9wdGlvbi5tYXAgZm9yX2ZpcnN0X3JlcXVlc3QgfmY6KGZ1biBmIGNvbm5lY3Rpb25fc3RhdGUgX2NsaWVudF9zdGF0ZSBxdWVyeSAtPlxuICAgICAgZiBjb25uZWN0aW9uX3N0YXRlIHF1ZXJ5KVxuICBpblxuICBsZXQgZiBjb25uZWN0aW9uX3N0YXRlIF9jbGllbnRfc3RhdGUgcXVlcnkgPSBmIGNvbm5lY3Rpb25fc3RhdGUgcXVlcnkgaW5cbiAgaW1wbGVtZW50X3dpdGhfY2xpZW50X3N0YXRlXG4gICAgfm9uX2NsaWVudF9hbmRfc2VydmVyX291dF9vZl9zeW5jXG4gICAgfmNyZWF0ZV9jbGllbnRfc3RhdGU6KGZ1biBfIC0+ICgpKVxuICAgID9mb3JfZmlyc3RfcmVxdWVzdFxuICAgIHRcbiAgICBmXG47O1xuXG5sZXQgaW1wbGVtZW50X3ZpYV9idXNcbiAgfm9uX2NsaWVudF9hbmRfc2VydmVyX291dF9vZl9zeW5jXG4gIH5jcmVhdGVfY2xpZW50X3N0YXRlXG4gID9vbl9jbGllbnRfZm9yZ290dGVuXG4gIHJwY1xuICBmXG4gID1cbiAgaW1wbGVtZW50X3dpdGhfY2xpZW50X3N0YXRlXG4gICAgfm9uX2NsaWVudF9hbmRfc2VydmVyX291dF9vZl9zeW5jXG4gICAgfmNyZWF0ZV9jbGllbnRfc3RhdGU6KGZ1biBjb25uZWN0aW9uX3N0YXRlIC0+XG4gICAgICBCdXNfc3RhdGUuY3JlYXRlICgpLCBjcmVhdGVfY2xpZW50X3N0YXRlIGNvbm5lY3Rpb25fc3RhdGUpXG4gICAgfm9uX2NsaWVudF9mb3Jnb3R0ZW46KGZ1biAoYnVzX3N0YXRlLCBjbGllbnRfc3RhdGUpIC0+XG4gICAgICBCdXNfc3RhdGUudW5zdWJzY3JpYmUgYnVzX3N0YXRlO1xuICAgICAgT3B0aW9uLml0ZXIgb25fY2xpZW50X2ZvcmdvdHRlbiB+ZjooZnVuIG9uX2NsaWVudF9mb3Jnb3R0ZW4gLT5cbiAgICAgICAgb25fY2xpZW50X2ZvcmdvdHRlbiBjbGllbnRfc3RhdGUpKVxuICAgIHJwY1xuICAgIH5mb3JfZmlyc3RfcmVxdWVzdDooZnVuIGNvbm5lY3Rpb25fc3RhdGUgKGJ1c19zdGF0ZSwgY2xpZW50X3N0YXRlKSBxdWVyeSAtPlxuICAgICAgKCogU2V0IHVwIHRoZSBidXMgc3Vic2NyaXB0aW9uIHRvIHRoZSBuZXcgcXVlcnkuICopXG4gICAgICBsZXQlYmluZC5FYWdlcl9kZWZlcnJlZCBidXMgPSBmIGNvbm5lY3Rpb25fc3RhdGUgY2xpZW50X3N0YXRlIHF1ZXJ5IGluXG4gICAgICAoKiBTdWJzY3JpYmUgdG8gdGhlIG5ldyBidXMsIHVuc3Vic2NyaWJpbmcgdG8gdGhlIHByZXZpb3VzIGJ1cyBpZiBuZWNlc3NhcnkuXG4gICAgICAgICBJdCBpcyBnb29kIHRvIHN1YnNjcmliZSB0byB0aGUgYnVzIGFzIGltbWVkaWF0ZWx5IGFmdGVyIHJlY2VpdmluZyB0aGUgYnVzXG4gICAgICAgICB2aWEgRWFnZXJfZGVmZXJyZWQsIHN1Y2ggdGhhdCB0aGUgcHVibGlzaGVyIHRvIHRoZSBidXMgaGFzIGFuIGFjY3VyYXRlXG4gICAgICAgICBjb3VudCBvZiBzdWJzY3JpYmVycyBmcm9tIFtCdXMubnVtX3N1YnNjcmliZXJzXS4gKilcbiAgICAgIEJ1c19zdGF0ZS5zdWJzY3JpYmUgYnVzX3N0YXRlIGJ1cztcbiAgICAgICgqIFdhaXQgZm9yIHRoZSBidXMgdG8gcHVibGlzaCBzb21ldGhpbmcgdG8gdGhlIFtCdXNfc3RhdGUudF0gc28gd2UgY2FuIHJldHVybiBpdCBhc1xuICAgICAgICAgdGhlIHJlc3BvbnNlLiAqKVxuICAgICAgQnVzX3N0YXRlLnRha2UgYnVzX3N0YXRlKVxuICAgIChmdW4gX2Nvbm5lY3Rpb25fc3RhdGUgKGJ1c19zdGF0ZSwgX2NsaWVudF9zdGF0ZSkgX3F1ZXJ5IC0+XG4gICAgICAoKiBGb3IgYWxsIHBvbGxzIGV4Y2VwdCB0aGUgZmlyc3Qgb25lIGZvciBlYWNoIHF1ZXJ5LCB3ZSBjYW4gc2ltcGx5IHdhaXRcbiAgICAgICAgICBmb3IgdGhlIGN1cnJlbnQgYnVzIHRvIHB1Ymxpc2ggYSBuZXcgcmVzcG9uc2UuIFdlIGlnbm9yZSB0aGUgcXVlcnksXG4gICAgICAgICAgYmVjYXVzZSB3ZSBrbm93IHRoYXQgdGhlIGJ1cyBzdWJzY3JpcHRpb24gb25seSBldmVyIGNvcnJlc3BvbmRzIHRvXG4gICAgICAgICAgdGhlIGN1cnJlbnQgcXVlcnkuICopXG4gICAgICBCdXNfc3RhdGUudGFrZSBidXNfc3RhdGUpXG47O1xuXG5sZXQgaW1wbGVtZW50X3ZpYV9idXMnXG4gIH5vbl9jbGllbnRfYW5kX3NlcnZlcl9vdXRfb2Zfc3luY1xuICB+Y3JlYXRlX2NsaWVudF9zdGF0ZVxuICA/b25fY2xpZW50X2ZvcmdvdHRlblxuICBycGNcbiAgZlxuICA9XG4gIGltcGxlbWVudF92aWFfYnVzXG4gICAgfm9uX2NsaWVudF9hbmRfc2VydmVyX291dF9vZl9zeW5jXG4gICAgfmNyZWF0ZV9jbGllbnRfc3RhdGVcbiAgICA/b25fY2xpZW50X2ZvcmdvdHRlblxuICAgIHJwY1xuICAgIChmdW4gY29ubmVjdGlvbl9zdGF0ZSBjbGllbnRfc3RhdGUgcXVlcnkgLT5cbiAgICBmIGNvbm5lY3Rpb25fc3RhdGUgY2xpZW50X3N0YXRlIHF1ZXJ5IHw+IERlZmVycmVkLnJldHVybilcbjs7XG5cbm1vZHVsZSBDbGllbnQgPSBzdHJ1Y3RcbiAgdHlwZSAoJ2EsICdiKSB4ID0gKCdhLCAnYikgdFxuXG4gIHR5cGUgKCdxdWVyeSwgJ3Jlc3BvbnNlLCAnZGlmZikgdW5wYWNrZWQgPVxuICAgIHsgbXV0YWJsZSBsYXN0X3NlcW51bSA6IFNlcW51bS50IG9wdGlvblxuICAgIDsgbXV0YWJsZSBsYXN0X3F1ZXJ5IDogJ3F1ZXJ5IG9wdGlvblxuICAgIDsgbXV0YWJsZSBsYXN0X3F1ZXJ5X2Rpc3BhdGNoX2lkIDogUXVlcnlfZGlzcGF0Y2hfaWQudFxuICAgIDsgbXV0YWJsZSBvdXQgOiAncmVzcG9uc2Ugb3B0aW9uXG4gICAgOyBtdXRhYmxlIHNlcXVlbmNlciA6IHVuaXQgU2VxdWVuY2VyLnRcbiAgICA7IGNsZWFuaW5nX3NlcXVlbmNlciA6IHVuaXQgU2VxdWVuY2VyLnRcbiAgICA7IGNsaWVudF9pZCA6IENsaWVudF9pZC50XG4gICAgOyBidXMgOiAoJ3F1ZXJ5IC0+ICdyZXNwb25zZSAtPiB1bml0KSBCdXMuUmVhZF93cml0ZS50XG4gICAgOyByZXNwb25zZV9tb2R1bGUgOlxuICAgICAgICAobW9kdWxlIFJlc3BvbnNlIHdpdGggdHlwZSB0ID0gJ3Jlc3BvbnNlIGFuZCB0eXBlIFVwZGF0ZS50ID0gJ2RpZmYpXG4gICAgOyBxdWVyeV9lcXVhbCA6ICdxdWVyeSAtPiAncXVlcnkgLT4gYm9vbFxuICAgIDsgdW5kZXJseWluZ19ycGMgOlxuICAgICAgICAoJ3F1ZXJ5IFJlcXVlc3QuU3RhYmxlLnQsICgncmVzcG9uc2UsICdkaWZmKSBSZXNwb25zZS5wYWlyKSBScGMuUnBjLnRcbiAgICA7IGZvbGQgOiAncmVzcG9uc2Ugb3B0aW9uIC0+ICdxdWVyeSAtPiAoJ3Jlc3BvbnNlLCAnZGlmZikgUmVzcG9uc2UudCAtPiAncmVzcG9uc2VcbiAgICB9XG5cbiAgdHlwZSAoJ3F1ZXJ5LCAncmVzcG9uc2UpIHQgPVxuICAgIHwgVCA6ICgncXVlcnksICdyZXNwb25zZSwgJ2RpZmYpIHVucGFja2VkIC0+ICgncXVlcnksICdyZXNwb25zZSkgdFxuXG4gIGxldCBkaXNwYXRjaF91bmRlcmx5aW5nIHQgY29ubmVjdGlvbiByZXF1ZXN0ID1cbiAgICBScGMuUnBjLmRpc3BhdGNoIHQudW5kZXJseWluZ19ycGMgY29ubmVjdGlvbiAoUmVxdWVzdC5zdGFibGVfb2ZfdW5zdGFibGUgcmVxdWVzdClcbiAgOztcblxuICBsZXQgY2FuY2VsX2N1cnJlbnRfaWZfcXVlcnlfY2hhbmdlZCB0IHEgY29ubmVjdGlvbiA9XG4gICAgKCogdXNlIHRoaXMgY2xlYW5pbmdfc2VxdWVuY2VyIGFzIGEgbG9jayB0byBwcmV2ZW50IHR3byBzdWJzZXF1ZW50IHF1ZXJpZXNcbiAgICAgICBmcm9tIG9ibGl0ZXJhdGluZyB0aGUgc2FtZSBzZXF1ZW5jZXIuICopXG4gICAgVGhyb3R0bGUuZW5xdWV1ZSB0LmNsZWFuaW5nX3NlcXVlbmNlciAoZnVuICgpIC0+XG4gICAgICBtYXRjaCB0Lmxhc3RfcXVlcnkgd2l0aFxuICAgICAgKCogSWYgdGhlcmUgd2FzIG5vIHByZXZpb3VzIHF1ZXJ5LCB3ZSBjYW4ga2VlcCB0aGUgZXhpc3Rpbmcgc2VxdWVuY2VyXG4gICAgICAgICBiZWNhdXNlIGl0cyB0b3RhbGx5IGVtcHR5LiAqKVxuICAgICAgfCBOb25lIC0+IERlZmVycmVkLk9yX2Vycm9yLm9rX3VuaXRcbiAgICAgICgqIElmIHRoZSBzZXF1ZW5jZXIgaXNuJ3QgcnVubmluZyBhbnl0aGluZyByaWdodCBub3csIHRoZW4gd2UgY2FuIGNvLW9wdCBpdFxuICAgICAgICAgZm9yIHRoaXMgcXVlcnkuICopXG4gICAgICB8IFNvbWUgXyB3aGVuIFRocm90dGxlLm51bV9qb2JzX3J1bm5pbmcgdC5zZXF1ZW5jZXIgPSAwIC0+IERlZmVycmVkLk9yX2Vycm9yLm9rX3VuaXRcbiAgICAgICgqIElmIHRoZSBjdXJyZW50IHF1ZXJ5IGlzIHRoZSBzYW1lIGFzIHRoZSBsYXN0IG9uZSwgdGhlbiB3ZSdyZSBmaW5lXG4gICAgICAgICBiZWNhdXNlIHRoZSBzZXF1ZW5jZXIgaXMgYWxyZWFkeSBydW5uaW5nIHRoYXQga2luZCBvZiBxdWVyeS4gKilcbiAgICAgIHwgU29tZSBxJyB3aGVuIHQucXVlcnlfZXF1YWwgcSBxJyAtPiBEZWZlcnJlZC5Pcl9lcnJvci5va191bml0XG4gICAgICAoKiBPdGhlcndpc2UsIHdlIG5lZWQgdG8gY2FuY2VsIHRoZSBjdXJyZW50IHJlcXVlc3QsIGtpbGwgZXZlcnkgdGFzayBjdXJyZW50bHlcbiAgICAgICAgIGluIHRoZSBzZXF1ZW5jZXIsIGFuZCBtYWtlIGEgbmV3IHNlcXVlbmNlciBmb3IgdGhpcyBxdWVyeS4gKilcbiAgICAgIHwgXyAtPlxuICAgICAgICBUaHJvdHRsZS5raWxsIHQuc2VxdWVuY2VyO1xuICAgICAgICBsZXQlYmluZCBjYW5jZWxfcmVzcG9uc2UgPVxuICAgICAgICAgIGRpc3BhdGNoX3VuZGVybHlpbmcgdCBjb25uZWN0aW9uIChDYW5jZWxfb25nb2luZyB0LmNsaWVudF9pZClcbiAgICAgICAgaW5cbiAgICAgICAgbGV0JW1hcCAoKSA9IFRocm90dGxlLmNsZWFuZWQgdC5zZXF1ZW5jZXIgaW5cbiAgICAgICAgdC5zZXF1ZW5jZXIgPC0gU2VxdWVuY2VyLmNyZWF0ZSB+Y29udGludWVfb25fZXJyb3I6dHJ1ZSAoKTtcbiAgICAgICAgKG1hdGNoIGNhbmNlbF9yZXNwb25zZSB3aXRoXG4gICAgICAgICB8IE9rIChSZXNwb25zZSBfKSAtPlxuICAgICAgICAgICBbJW1lc3NhZ2UgXCJCVUdcIiBbJWhlcmVdIFwicmVndWxhciByZXNwb25zZSBjYXVzZWQgYnkgY2FuY2VsbGF0aW9uXCJdXG4gICAgICAgICAgIHw+IE9yX2Vycm9yLmVycm9yX3NcbiAgICAgICAgIHwgT2sgQ2FuY2VsbGF0aW9uX3N1Y2Nlc3NmdWwgLT4gT2sgKClcbiAgICAgICAgIHwgRXJyb3IgZSAtPiBFcnJvciBlKSlcbiAgOztcblxuICBsZXQgZGlzcGF0Y2gnIHQgY29ubmVjdGlvbiBxdWVyeSA9XG4gICAgdC5sYXN0X3F1ZXJ5IDwtIFNvbWUgcXVlcnk7XG4gICAgbGV0JWJpbmQgcmVzcG9uc2UgPVxuICAgICAgbGV0IGxhc3Rfc2VxbnVtID0gdC5sYXN0X3NlcW51bSBpblxuICAgICAgbGV0IGNsaWVudF9pZCA9IHQuY2xpZW50X2lkIGluXG4gICAgICBkaXNwYXRjaF91bmRlcmx5aW5nIHQgY29ubmVjdGlvbiAoUXVlcnkgeyBxdWVyeTsgbGFzdF9zZXFudW07IGNsaWVudF9pZCB9KVxuICAgIGluXG4gICAgbWF0Y2ggcmVzcG9uc2Ugd2l0aFxuICAgIHwgT2sgKFJlc3BvbnNlIHsgcmVzcG9uc2U7IG5ld19zZXFudW0gfSkgLT5cbiAgICAgIGxldCBuZXdfb3V0ID0gdC5mb2xkIHQub3V0IHF1ZXJ5IHJlc3BvbnNlIGluXG4gICAgICB0Lmxhc3Rfc2VxbnVtIDwtIFNvbWUgbmV3X3NlcW51bTtcbiAgICAgIHQub3V0IDwtIFNvbWUgbmV3X291dDtcbiAgICAgIEJ1cy53cml0ZTIgdC5idXMgcXVlcnkgbmV3X291dDtcbiAgICAgIHJldHVybiAoT2sgbmV3X291dClcbiAgICB8IE9rIENhbmNlbGxhdGlvbl9zdWNjZXNzZnVsIC0+XG4gICAgICBbJW1lc3NhZ2UgXCJCVUdcIiBbJWhlcmVdIFwiY2FuY2VsbGF0aW9uIGNhdXNlZCBieSByZWd1bGFyIHJlcXVlc3RcIl1cbiAgICAgIHw+IE9yX2Vycm9yLmVycm9yX3NcbiAgICAgIHw+IHJldHVyblxuICAgIHwgRXJyb3IgZSAtPiByZXR1cm4gKEVycm9yIGUpXG4gIDs7XG5cbiAgKCogVGhlc2UgYXJlIGVycm9ycyBkZWZpbmVkIGJ5IHNlcXVlbmNlcjsgc3F1aXNoIHRoZW0gaW50byBPcl9lcnJvci50ICopXG4gIGxldCBjb2xsYXBzZV9zZXF1ZW5jZXJfZXJyb3IgPSBmdW5jdGlvblxuICAgIHwgYE9rIHJlc3VsdF9vcl9lcnJvciAtPiByZXN1bHRfb3JfZXJyb3JcbiAgICB8IGBBYm9ydGVkIC0+IEVycm9yIChFcnJvci5vZl9zdHJpbmcgXCJSZXF1ZXN0IGFib3J0ZWRcIilcbiAgICB8IGBSYWlzZWQgZXhuIC0+IEVycm9yIChFcnJvci5vZl9leG4gZXhuKVxuICA7O1xuXG4gICgqIFVzZSBhIHNlcXVlbmNlciB0byBlbnN1cmUgdGhhdCB0aGVyZSBhcmVuJ3QgYW55IHNlcXVlbnRpYWwgb3V0Z29pbmcgcmVxdWVzdHMgKilcbiAgbGV0IGRpc3BhdGNoIChUIHQpIGNvbm5lY3Rpb24gcXVlcnkgPVxuICAgIGxldCBxdWVyeV9kaXNwYXRjaF9pZCA9IFF1ZXJ5X2Rpc3BhdGNoX2lkLmNyZWF0ZSAoKSBpblxuICAgIHQubGFzdF9xdWVyeV9kaXNwYXRjaF9pZCA8LSBxdWVyeV9kaXNwYXRjaF9pZDtcbiAgICBsZXQlYmluZC5EZWZlcnJlZC5Pcl9lcnJvciAoKSA9IGNhbmNlbF9jdXJyZW50X2lmX3F1ZXJ5X2NoYW5nZWQgdCBxdWVyeSBjb25uZWN0aW9uIGluXG4gICAgKGlmIG5vdCAoUXVlcnlfZGlzcGF0Y2hfaWQuZXF1YWwgdC5sYXN0X3F1ZXJ5X2Rpc3BhdGNoX2lkIHF1ZXJ5X2Rpc3BhdGNoX2lkKVxuICAgICB0aGVuIHJldHVybiBgQWJvcnRlZFxuICAgICBlbHNlIFRocm90dGxlLmVucXVldWUnIHQuc2VxdWVuY2VyIChmdW4gKCkgLT4gZGlzcGF0Y2gnIHQgY29ubmVjdGlvbiBxdWVyeSkpXG4gICAgPj58IGNvbGxhcHNlX3NlcXVlbmNlcl9lcnJvclxuICA7O1xuXG4gIGxldCByZWRpc3BhdGNoIChUIHQpIGNvbm5lY3Rpb24gPVxuICAgIFRocm90dGxlLmVucXVldWUnIHQuc2VxdWVuY2VyIChmdW4gKCkgLT5cbiAgICAgIG1hdGNoIHQubGFzdF9xdWVyeSB3aXRoXG4gICAgICB8IFNvbWUgcSAtPiBkaXNwYXRjaCcgdCBjb25uZWN0aW9uIHFcbiAgICAgIHwgTm9uZSAtPlxuICAgICAgICBcIltyZWRpc3BhdGNoXSBjYWxsZWQgYmVmb3JlIGEgcXVlcnkgd2FzIHNldCBvciBhIHJlZ3VsYXIgZGlzcGF0Y2ggaGFkIGNvbXBsZXRlZFwiXG4gICAgICAgIHw+IEVycm9yLm9mX3N0cmluZ1xuICAgICAgICB8PiBFcnJvclxuICAgICAgICB8PiBEZWZlcnJlZC5yZXR1cm4pXG4gICAgPj58IGNvbGxhcHNlX3NlcXVlbmNlcl9lcnJvclxuICA7O1xuXG4gIGxldCBmb3JnZXRfb25fc2VydmVyIChUIHQpIGNvbm5lY3Rpb24gPVxuICAgIHQubGFzdF9xdWVyeV9kaXNwYXRjaF9pZCA8LSBRdWVyeV9kaXNwYXRjaF9pZC5jcmVhdGUgKCk7XG4gICAgbWF0Y2ggdC5sYXN0X3F1ZXJ5IHdpdGhcbiAgICAoKiBJZiB0aGVyZSB3YXMgbm8gcHJldmlvdXMgcXVlcnksIHRoZW4gdGhlIHNlcnZlciBoYXMgbm90aGluZyB0byBmb3JnZXQuICopXG4gICAgfCBOb25lIC0+IERlZmVycmVkLk9yX2Vycm9yLm9rX3VuaXRcbiAgICB8IFNvbWUgcXVlcnkgLT5cbiAgICAgIFRocm90dGxlLmVucXVldWUnIHQuY2xlYW5pbmdfc2VxdWVuY2VyIChmdW4gKCkgLT5cbiAgICAgICAgVGhyb3R0bGUua2lsbCB0LnNlcXVlbmNlcjtcbiAgICAgICAgbGV0JWJpbmQgZm9yZ2V0X3Jlc3BvbnNlID1cbiAgICAgICAgICBkaXNwYXRjaF91bmRlcmx5aW5nXG4gICAgICAgICAgICB0XG4gICAgICAgICAgICBjb25uZWN0aW9uXG4gICAgICAgICAgICAoRm9yZ2V0X2NsaWVudCB7IHF1ZXJ5OyBjbGllbnRfaWQgPSB0LmNsaWVudF9pZCB9KVxuICAgICAgICBpblxuICAgICAgICBsZXQlbWFwICgpID0gVGhyb3R0bGUuY2xlYW5lZCB0LnNlcXVlbmNlciBpblxuICAgICAgICB0LnNlcXVlbmNlciA8LSBTZXF1ZW5jZXIuY3JlYXRlIH5jb250aW51ZV9vbl9lcnJvcjp0cnVlICgpO1xuICAgICAgICBtYXRjaCBmb3JnZXRfcmVzcG9uc2Ugd2l0aFxuICAgICAgICB8IE9rIChSZXNwb25zZSBfKSAtPlxuICAgICAgICAgICgqIEl0IGlzIHBvc3NpYmxlIHRoYXQgbmV3IGNsaWVudHMgb2Ygb2xkIHNlcnZlcnMgd2lsbCBnZXRcbiAgICAgICAgICAgICBzcGFtbWVkIHdpdGggdGhpcyBtZXNzYWdlIGlmIFtmb3JnZXRfb25fc2VydmVyXSBpcyBjYWxsZWQgYSBsb3QuIEhvd2V2ZXIsXG4gICAgICAgICAgICAgdGhpcyBzb3VuZHMgbGlrZSBhbiB1bmxpa2VseSBjYXNlIHRvIG1lLCBzaW5jZSBvbGQgc2VydmVycyBwcm9iYWJseSB3b24ndFxuICAgICAgICAgICAgIGV4aXN0IGZvciBtdWNoIGxvbmdlcjsgaW4gYWRkaXRpb24sIHNwYW1taW5nIHRoaXMgbWVzc2FnZSBpcyBub3QgdGVycmlibGUuICopXG4gICAgICAgICAgT3JfZXJyb3IuZXJyb3Jfc1xuICAgICAgICAgICAgWyVtZXNzYWdlXG4gICAgICAgICAgICAgIFwiQlVHXCJcbiAgICAgICAgICAgICAgICBbJWhlcmVdXG4gICAgICAgICAgICAgICAge3xSZWd1bGFyIHJlc3BvbnNlIGNhdXNlZCBieSBmb3JnZXQgcmVxdWVzdC4gVGhpcyBjYW4gYWxzbyBoYXBwZW4gaWYgdGhlIHNlcnZlciBpcyBvbGQgYW5kIGRvZXMgbm90IHN1cHBvcnQgZm9yZ2V0IHJlcXVlc3RzLCBpbiB3aGljaCBjYXNlIHRoaXMgaXMgbm90IGEgYnVnLnx9XVxuICAgICAgICB8IE9rIENhbmNlbGxhdGlvbl9zdWNjZXNzZnVsIC0+IE9rICgpXG4gICAgICAgIHwgRXJyb3IgZSAtPiBFcnJvciBlKVxuICAgICAgPj58IGNvbGxhcHNlX3NlcXVlbmNlcl9lcnJvclxuICA7O1xuXG4gIGxldCBxdWVyeSAoVCB7IGxhc3RfcXVlcnk7IF8gfSkgPSBsYXN0X3F1ZXJ5XG4gIGxldCBidXMgKFQgeyBidXM7IF8gfSkgPSBCdXMucmVhZF9vbmx5IGJ1c1xuXG4gIGxldCBjcmVhdGUgKHR5cGUgcXVlcnkgcmVzcG9uc2UpID9pbml0aWFsX3F1ZXJ5ICh0IDogKHF1ZXJ5LCByZXNwb25zZSkgeCkgPVxuICAgIGxldCAoVCB7IHF1ZXJ5X2VxdWFsOyB1bmRlcmx5aW5nX3JwYzsgcmVzcG9uc2VfbW9kdWxlIH0gOiBfIHgpID0gdCBpblxuICAgIGxldCBtb2R1bGUgTSA9ICh2YWwgcmVzcG9uc2VfbW9kdWxlKSBpblxuICAgIGxldCBmIHByZXYgX3F1ZXJ5ID0gZnVuY3Rpb25cbiAgICAgIHwgUmVzcG9uc2UuRnJlc2ggciAtPiByXG4gICAgICB8IFVwZGF0ZSBkaWZmcyAtPlxuICAgICAgICAobWF0Y2ggcHJldiB3aXRoXG4gICAgICAgICB8IE5vbmUgLT5cbiAgICAgICAgICAgcmFpc2Vfc1xuICAgICAgICAgICAgIFslbWVzc2FnZVxuICAgICAgICAgICAgICAgXCJCVUdcIiBbJWhlcmVdIFwicmVjZWl2ZWQgYW4gdXBkYXRlIHdpdGhvdXQgcmVjZWl2aW5nIGFueSBwcmV2aW91cyB2YWx1ZXNcIl1cbiAgICAgICAgIHwgU29tZSBwcmV2IC0+IE0udXBkYXRlIHByZXYgZGlmZnMpXG4gICAgaW5cbiAgICBsZXQgYnVzID1cbiAgICAgIEJ1cy5jcmVhdGVfZXhuXG4gICAgICAgIFslaGVyZV1cbiAgICAgICAgQnVzLkNhbGxiYWNrX2FyaXR5LkFyaXR5MlxuICAgICAgICB+b25fY2FsbGJhY2tfcmFpc2U6KGZ1biBlcnJvciAtPlxuICAgICAgICAgIGxldCB0YWcgPSBcImV4Y2VwdGlvbiB0aHJvd24gZnJvbSBpbnNpZGUgb2YgcG9sbGluZy1zdGF0ZS1ycGMgYnVzIGhhbmRsZXJcIiBpblxuICAgICAgICAgIGVycm9yIHw+IEVycm9yLnRhZyB+dGFnIHw+IFslc2V4cF9vZjogRXJyb3IudF0gfD4gZXByaW50X3MpXG4gICAgICAgIH5vbl9zdWJzY3JpcHRpb25fYWZ0ZXJfZmlyc3Rfd3JpdGU6QWxsb3dfYW5kX3NlbmRfbGFzdF92YWx1ZVxuICAgIGluXG4gICAgbGV0IHNlcXVlbmNlciA9IFNlcXVlbmNlci5jcmVhdGUgfmNvbnRpbnVlX29uX2Vycm9yOnRydWUgKCkgaW5cbiAgICBsZXQgY2xlYW5pbmdfc2VxdWVuY2VyID0gU2VxdWVuY2VyLmNyZWF0ZSB+Y29udGludWVfb25fZXJyb3I6dHJ1ZSAoKSBpblxuICAgIFRcbiAgICAgIHsgYnVzXG4gICAgICA7IHNlcXVlbmNlclxuICAgICAgOyBjbGVhbmluZ19zZXF1ZW5jZXJcbiAgICAgIDsgbGFzdF9zZXFudW0gPSBOb25lXG4gICAgICA7IGxhc3RfcXVlcnkgPSBpbml0aWFsX3F1ZXJ5XG4gICAgICA7IGxhc3RfcXVlcnlfZGlzcGF0Y2hfaWQgPSBRdWVyeV9kaXNwYXRjaF9pZC5jcmVhdGUgKClcbiAgICAgIDsgb3V0ID0gTm9uZVxuICAgICAgOyByZXNwb25zZV9tb2R1bGVcbiAgICAgIDsgcXVlcnlfZXF1YWxcbiAgICAgIDsgdW5kZXJseWluZ19ycGNcbiAgICAgIDsgZm9sZCA9IGZcbiAgICAgIDsgY2xpZW50X2lkID0gQ2xpZW50X2lkLmNyZWF0ZSAoKVxuICAgICAgfVxuICA7O1xuZW5kXG5cbm1vZHVsZSBQcml2YXRlX2Zvcl90ZXN0aW5nID0gc3RydWN0XG4gIG1vZHVsZSBSZXNwb25zZScgPSBzdHJ1Y3RcbiAgICB0eXBlICdyZXNwb25zZSB0ID1cbiAgICAgIHwgRnJlc2ggOiAncmVzcG9uc2UgLT4gJ3Jlc3BvbnNlIHRcbiAgICAgIHwgVXBkYXRlIDpcbiAgICAgICAgICB7IHQgOiAndXBkYXRlXG4gICAgICAgICAgOyBzZXhwX29mIDogJ3VwZGF0ZSAtPiBTZXhwLnRcbiAgICAgICAgICB9XG4gICAgICAgICAgLT4gJ3Jlc3BvbnNlIHRcblxuICAgIGxldCBzZXhwX29mX3Qgc2V4cF9vZl9hID0gZnVuY3Rpb25cbiAgICAgIHwgRnJlc2ggYSAtPiBbJXNleHAgRnJlc2ggKHNleHBfb2ZfYSBhIDogU2V4cC50KV1cbiAgICAgIHwgVXBkYXRlIHsgdDsgc2V4cF9vZiB9IC0+IFslc2V4cCBVcGRhdGUgKHNleHBfb2YgdCA6IFNleHAudCldXG4gICAgOztcbiAgZW5kXG5cbiAgbGV0IGNyZWF0ZV9jbGllbnRcbiAgICAodHlwZSBxdWVyeSByZXNwb25zZSlcbiAgICA/aW5pdGlhbF9xdWVyeVxuICAgICh0IDogKHF1ZXJ5LCByZXNwb25zZSkgdClcbiAgICB+aW50cm9zcGVjdFxuICAgID1cbiAgICAoKiBNYWtlIGEgbmV3IGZ1bmN0aW9uIHRvIGludHJvZHVjZSBhIGxvY2FsbHkgYWJzdHJhY3QgdHlwZSBmb3IgW2RpZmZdICopXG4gICAgbGV0IG1ha2VfZm9sZFxuICAgICAgOiB0eXBlIGRpZmYuXG4gICAgICAgIGZvbGQ6KHJlc3BvbnNlIG9wdGlvbiAtPiBxdWVyeSAtPiAocmVzcG9uc2UsIGRpZmYpIFJlc3BvbnNlLnQgLT4gcmVzcG9uc2UpXG4gICAgICAgIC0+IHJlc3BvbnNlX21vZHVsZTpcbiAgICAgICAgICAgICAobW9kdWxlIFJlc3BvbnNlIHdpdGggdHlwZSB0ID0gcmVzcG9uc2UgYW5kIHR5cGUgVXBkYXRlLnQgPSBkaWZmKVxuICAgICAgICAtPiByZXNwb25zZSBvcHRpb25cbiAgICAgICAgLT4gcXVlcnlcbiAgICAgICAgLT4gKHJlc3BvbnNlLCBkaWZmKSBSZXNwb25zZS50XG4gICAgICAgIC0+IHJlc3BvbnNlXG4gICAgICA9XG4gICAgICBmdW4gfmZvbGQgfnJlc3BvbnNlX21vZHVsZSAtPlxuICAgICAgbGV0IG1vZHVsZSBNID0gKHZhbCByZXNwb25zZV9tb2R1bGUpIGluXG4gICAgICBsZXQgZm9sZCBwcmV2IHF1ZXJ5IChyZXNwIDogKHJlc3BvbnNlLCBkaWZmKSBSZXNwb25zZS50KSA9XG4gICAgICAgIGxldCByZXNwJyA9XG4gICAgICAgICAgbWF0Y2ggcmVzcCB3aXRoXG4gICAgICAgICAgfCBSZXNwb25zZS5GcmVzaCByIC0+IFJlc3BvbnNlJy5GcmVzaCByXG4gICAgICAgICAgfCBVcGRhdGUgZGlmZnMgLT4gVXBkYXRlIHsgdCA9IGRpZmZzOyBzZXhwX29mID0gWyVzZXhwX29mOiBNLlVwZGF0ZS50XSB9XG4gICAgICAgIGluXG4gICAgICAgIGludHJvc3BlY3QgcHJldiBxdWVyeSByZXNwJztcbiAgICAgICAgZm9sZCBwcmV2IHF1ZXJ5IHJlc3BcbiAgICAgIGluXG4gICAgICBmb2xkXG4gICAgaW5cbiAgICBsZXQgKFQgY2xpZW50KSA9IENsaWVudC5jcmVhdGUgP2luaXRpYWxfcXVlcnkgdCBpblxuICAgIGxldCBuZXdfZm9sZCA9IG1ha2VfZm9sZCB+Zm9sZDpjbGllbnQuZm9sZCB+cmVzcG9uc2VfbW9kdWxlOmNsaWVudC5yZXNwb25zZV9tb2R1bGUgaW5cbiAgICBDbGllbnQuVCB7IGNsaWVudCB3aXRoIGZvbGQgPSBuZXdfZm9sZCB9XG4gIDs7XG5cbiAgbW9kdWxlIFJlc3BvbnNlID0gUmVzcG9uc2UnXG5lbmRcbiJdfQ==
